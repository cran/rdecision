<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Andrew J. Sims" />


<title>Elementary Semi-Markov Model (Chancellor 1997)</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Elementary Semi-Markov Model (Chancellor
1997)</h1>
<h3 class="subtitle">Monotherapy versus combination therapy for HIV</h3>
<h4 class="author">Andrew J. Sims</h4>
<h4 class="date">May 2021</h4>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>This vignette is an example of an elementary semi-Markov model using
the <code>rdecision</code> package. It is based on the example given by
Briggs <em>et al</em><span class="citation"><sup>1</sup></span>
(Exercise 2.5) which itself is based on a model described by Chancellor
<em>et al</em><span class="citation"><sup>2</sup></span>. The model
compares a combination therapy of Lamivudine/Zidovudine versus
Zidovudine monotherapy in people with HIV infection.</p>
</div>
<div id="creating-the-model" class="section level1">
<h1>Creating the model</h1>
<div id="model-structure" class="section level2">
<h2>Model structure</h2>
<p>The model is constructed by forming a graph, with each state as a
node and each transition as an edge. Nodes of class
<code>MarkovState</code> and edges of class <code>Transition</code> have
various properties whose values reflect the variables of the model
(costs, rates etc.). Because the model is intended to evaluate survival,
the utility of states A, B and C are set to 1 (by default) and state D
to zero. Thus the incremental quality adjusted life years gained per
cycle is equivalent to the survival function. Because the structure of
the model is identical for monotherapy and combination therapy, we will
use the same model throughout. For this reason, the costs of occupancy
of each state and the costs of making transitions between states are set
to zero when the model is created, and will be changed each time the
model is run.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create Markov states</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>sA <span class="ot">&lt;-</span> MarkovState<span class="sc">$</span><span class="fu">new</span>(<span class="st">&quot;A&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>sB <span class="ot">&lt;-</span> MarkovState<span class="sc">$</span><span class="fu">new</span>(<span class="st">&quot;B&quot;</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>sC <span class="ot">&lt;-</span> MarkovState<span class="sc">$</span><span class="fu">new</span>(<span class="st">&quot;C&quot;</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>sD <span class="ot">&lt;-</span> MarkovState<span class="sc">$</span><span class="fu">new</span>(<span class="st">&quot;D&quot;</span>, <span class="at">utility =</span> <span class="fl">0.0</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create transitions</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>tAA <span class="ot">&lt;-</span> Transition<span class="sc">$</span><span class="fu">new</span>(sA, sA)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>tAB <span class="ot">&lt;-</span> Transition<span class="sc">$</span><span class="fu">new</span>(sA, sB)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>tAC <span class="ot">&lt;-</span> Transition<span class="sc">$</span><span class="fu">new</span>(sA, sC)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>tAD <span class="ot">&lt;-</span> Transition<span class="sc">$</span><span class="fu">new</span>(sA, sD)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>tBB <span class="ot">&lt;-</span> Transition<span class="sc">$</span><span class="fu">new</span>(sB, sB)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>tBC <span class="ot">&lt;-</span> Transition<span class="sc">$</span><span class="fu">new</span>(sB, sC)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>tBD <span class="ot">&lt;-</span> Transition<span class="sc">$</span><span class="fu">new</span>(sB, sD)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>tCC <span class="ot">&lt;-</span> Transition<span class="sc">$</span><span class="fu">new</span>(sC, sC)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>tCD <span class="ot">&lt;-</span> Transition<span class="sc">$</span><span class="fu">new</span>(sC, sD)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>tDD <span class="ot">&lt;-</span> Transition<span class="sc">$</span><span class="fu">new</span>(sD, sD)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># set discount rates</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>cDR <span class="ot">&lt;-</span> <span class="fl">6.0</span> <span class="co"># annual discount rate, costs (%)</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>oDR <span class="ot">&lt;-</span> <span class="fl">0.0</span> <span class="co"># annual discount rate, benefits (%)</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># construct the model</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> SemiMarkovModel<span class="sc">$</span><span class="fu">new</span>(</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">V =</span> <span class="fu">list</span>(sA, sB, sC, sD),</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">E =</span> <span class="fu">list</span>(tAA, tAB, tAC, tAD, tBB, tBC, tBD, tCC, tCD, tDD),</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">discount.cost =</span> cDR <span class="sc">/</span> <span class="fl">100.0</span>,</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">discount.utility =</span> oDR <span class="sc">/</span> <span class="fl">100.0</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="costs-and-discounts" class="section level2">
<h2>Costs and discounts</h2>
<p>The costs and discount rates used in the model (1995 rates) are
numerical constants, and are defined as follows.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># drug costs</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>cAZT <span class="ot">&lt;-</span> <span class="fl">2278.0</span> <span class="co"># zidovudine drug cost</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>cLam <span class="ot">&lt;-</span> <span class="fl">2087.0</span> <span class="co"># lamivudine drug cost</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># direct medical and community costs</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>dmca <span class="ot">&lt;-</span> <span class="fl">1701.0</span> <span class="co"># direct medical costs associated with state A</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>dmcb <span class="ot">&lt;-</span> <span class="fl">1774.0</span> <span class="co"># direct medical costs associated with state B</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>dmcc <span class="ot">&lt;-</span> <span class="fl">6948.0</span> <span class="co"># direct medical costs associated with state C</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>ccca <span class="ot">&lt;-</span> <span class="fl">1055.0</span> <span class="co"># Community care costs associated with state A</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>cccb <span class="ot">&lt;-</span> <span class="fl">1278.0</span> <span class="co"># Community care costs associated with state B</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>cccc <span class="ot">&lt;-</span> <span class="fl">2059.0</span> <span class="co"># Community care costs associated with state C</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># occupancy costs with monotherapy</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>cAm <span class="ot">&lt;-</span> dmca <span class="sc">+</span> ccca <span class="sc">+</span> cAZT</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>cBm <span class="ot">&lt;-</span> dmcb <span class="sc">+</span> cccb <span class="sc">+</span> cAZT</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>cCm <span class="ot">&lt;-</span> dmcc <span class="sc">+</span> cccc <span class="sc">+</span> cAZT</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># occupancy costs with combination therapy</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>cAc <span class="ot">&lt;-</span> dmca <span class="sc">+</span> ccca <span class="sc">+</span> cAZT <span class="sc">+</span> cLam</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>cBc <span class="ot">&lt;-</span> dmcb <span class="sc">+</span> cccb <span class="sc">+</span> cAZT <span class="sc">+</span> cLam</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>cCc <span class="ot">&lt;-</span> dmcc <span class="sc">+</span> cccc <span class="sc">+</span> cAZT <span class="sc">+</span> cLam</span></code></pre></div>
</div>
<div id="treatment-effect" class="section level2">
<h2>Treatment effect</h2>
<p>The treatment effect was estimated by Chancellor <em>et al</em><span class="citation"><sup>2</sup></span> via a meta-analysis, and is defined
as follows:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>RR <span class="ot">&lt;-</span> <span class="fl">0.509</span></span></code></pre></div>
</div>
<div id="transition-rates-and-probabilities" class="section level2">
<h2>Transition rates and probabilities</h2>
<p>Briggs <em>et al</em><span class="citation"><sup>1</sup></span>
interpreted the observed transition counts in 1 year as transition
probabilities by dividing counts by the total transitions observed from
each state. With this assumption, the annual (per-cycle) transition
probabilities are calculated as follows and applied to the model via the
<code>set_probabilities</code> function.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transition counts</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>nAA <span class="ot">&lt;-</span> 1251L</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>nAB <span class="ot">&lt;-</span> 350L</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>nAC <span class="ot">&lt;-</span> 116L</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>nAD <span class="ot">&lt;-</span> 17L</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>nBB <span class="ot">&lt;-</span> 731L</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>nBC <span class="ot">&lt;-</span> 512L</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>nBD <span class="ot">&lt;-</span> 15L</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>nCC <span class="ot">&lt;-</span> 1312L</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>nCD <span class="ot">&lt;-</span> 437L</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># create transition matrix</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>nA <span class="ot">&lt;-</span> nAA <span class="sc">+</span> nAB <span class="sc">+</span> nAC <span class="sc">+</span> nAD</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>nB <span class="ot">&lt;-</span> nBB <span class="sc">+</span> nBC <span class="sc">+</span> nBD</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>nC <span class="ot">&lt;-</span> nCC <span class="sc">+</span> nCD</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>Ptm <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(nAA <span class="sc">/</span> nA, nAB <span class="sc">/</span> nA, nAC <span class="sc">/</span> nA, nAD <span class="sc">/</span> nA,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0</span>, nBB <span class="sc">/</span> nB, nBC <span class="sc">/</span> nB, nBD <span class="sc">/</span> nB,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0</span>,      <span class="fl">0.0</span>, nCC <span class="sc">/</span> nC, nCD <span class="sc">/</span> nC,</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0</span>,      <span class="fl">0.0</span>,      <span class="fl">0.0</span>,      <span class="fl">1.0</span>),</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> 4L, <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">dimnames =</span> <span class="fu">list</span>(</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">source =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>), <span class="at">target =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>More usually, fully observed transition counts are converted into
transition rates, rather than probabilities, as described by Welton and
Ades<span class="citation"><sup>3</sup></span>. This is because counting
events and measuring total time at risk includes individuals who make
more than one transition during the observation time, and can lead to
rates with values which exceed 1. In contrast, the difference between a
census of the number of individuals in each state at the start of the
interval and a census at the end is directly related to the per-cycle
probability. As Miller and Homan<span class="citation"><sup>4</sup></span>, Welton and Ades<span class="citation"><sup>3</sup></span>, Jones <em>et al</em><span class="citation"><sup>5</sup></span> and others note, conversion between
rates and probabilities for multi-state Markov models is
non-trivial<span class="citation"><sup>5</sup></span> and care is needed
when modellers calculate probabilities from published rates for use in
<code>SemiMarkoModel</code>s.</p>
</div>
</div>
<div id="checking-the-model" class="section level1">
<h1>Checking the model</h1>
<div id="diagram" class="section level2">
<h2>Diagram</h2>
<p>A representation of the model in DOT format (<a href="https://graphviz.org">Graphviz</a>) can be created using the
<code>as_DOT</code> function of <code>SemiMarkovModel</code>. The
function returns a character vector which can be saved in a file
(<code>.gv</code> extension) for visualization with the <code>dot</code>
tool of Graphviz, or plotted directly in R via the
<code>DiagrammeR</code> package. The Markov model is shown in the figure
below.</p>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMwAAAFbCAYAAACZNmG9AAAABmJLR0QA/wD/AP+gvaeTAAAgAElEQVR4nOydZ1gU19vG79lK79KxoKAUkVVK7GJJjDU27GIvMZZILNEYNUVfExWNJRKjhhijoMZYIiJiAxUsWEBRNNgAAQGVvgvs834w8Leggs7s7ML+rssvQO7nHsK9Z86ZOc9hiIigRYuWaiHg24AWLZqENjBatNQAbWC0aKkBIr4NaAFyc3Px8OFDPHnyBMXFxZDL5SgqKoJIJIKhoSGEQiFMTExgZWUFKysrCIVCvi3XWbSBURFEhOvXryM+Ph6JiYlITEzEzZs3kZaWhpKSkmrrCIVCWFlZwdHREe7u7nB3d4eHhwe8vb2ho6PD4RVoAQBGu0rGHffu3cOBAwdw7NgxREdHIzs7G1KpFC4uLnBzc4OLiwscHBxgY2MDW1tbmJmZQUdHB1KpFHp6eigtLUVBQQGUSiVyc3ORmZmJ9PR0pKen4+bNm7h+/ToSExORm5sLqVQKHx8fdOrUCT169ICvry8YhuH7V1Dr0AaGZdLS0hASEoK//voLFy9ehLGxMTp27IhOnTqhQ4cOaNGiBUQidgf2e/fu4eTJkzh16hSOHz+OlJQU2NnZ4ZNPPsHw4cPRunVrVuvVaUjLe6NUKikiIoI++eQTEolEZGFhQRMnTqTw8HCSy+Uq93P16lVasmQJeXh4EABq0aIFbdiwgfLz81XupbahDcx7EhkZSd7e3gSAWrVqRcHBwVRUVMS3rUouXLhAEydOJH19fTI3N6dFixbRkydP+LalsWhvyd6RuLg4fPbZZ7h48SL69u2LRYsWwdPTk29bryU7OxurVq3CunXrIJVK8d1332HChAkQCF7/ZOHJkyfIzMxEdnY2cnJyIJfLATxbeLCwsIC5uTksLS1Rr149VV0G//CdWE3j8ePHNGnSJBIIBOTn50eXLl3i21KNyM7OpsDAQBKLxeTj40MXL14khUJBsbGxtHr1aho1ahT5+vqSmZkZAajWPzMzM2rfvj1NnTqVdu/eTTk5OXxfJmdoR5gacPr0aQwbNgwKhQIrVqzA8OHD+bb0ziQmJuLTTz9FbGwsTE1NkZWVBXNzc3h5eaFZs2ZwdnaGo6MjbGxsYG5uDnNzc+jq6gIASktLkZOTg5ycHGRlZSEpKQkJCQm4ePEi4uPjQURo3749xo4diwEDBkBfX5/nq2URngOrMSxbtoxEIhH16tWLHj16xLcdVlAqlbR8+XISiUTUvn17ys3NfW/N3Nxc2r17N/Xv358kEgmZmJjQN998Q3l5eSw45h9tYN5CWVkZTZw4kYRCIQUFBZFSqeTbEuvExsaSvb09ubu704MHD1jTffToES1ZsoSMjY3JwsKC/vjjD9a0+UIbmDdQWlpK/fr1Iz09Pdq3bx/fdjjl/v375ObmRg4ODnT79m1WtXNzc2natGnEMAwNHDhQo1fptIF5DUqlkgICAkhfX59iYmL4tqMScnNzycvLixo3bkwZGRms6x89epRsbW3J09OTHj58yLq+KtAG5jUsWLCAJBIJHT58mG8rKiUrK4ucnZ2pZcuWVFxczLr+nTt3yNnZmZycnDRyLqgNTBUcPXqUBAIBbdq0iW8rvPDvv/+SiYkJTZ06lRP9zMxMatiwIfn5+VFpaSknNbhCG5iXyM3NJVtbW/L39+fbCq+EhoYSwzB08OBBTvQvX75M+vr6tHDhQk70uUIbmJcIDAwkS0tLevz4MW8ekpOTCQD5+vry5oGIaOjQoeTk5EQKhYIT/VWrVpFUKqVbt25xos8F2sA8R0pKCkmlUlq/fj2vPr788svKp+jXrl3jzcfdu3dJR0eH1q5dy4m+QqGgZs2a0fDhwznR5wJtYJ7j888/p0aNGnH2iVodysvLyc7OjmQyGQGgL774gjcvRETTp0+nRo0aUXl5OSf6W7ZsIYlEojELANrA/IdCoaB69erRt99+y6uP8PBwatCgAZ0/f54AkJWVFa8T46SkJAJAUVFRnOgXFBSQkZERrVmzhhN9ttE2wfiPqKgoZGdnIyAggFcfW7ZswejRo+Hl5QUPDw9kZmbi0KFDvPlp1qwZfH198eeff3Kir6+vjx49eiAiIoITfbbRBuY/oqOj0bRpUzg4OPDmITc3FwcOHKgM7ZgxYwA8CxGfdO3aFTExMZzpf/DBB4iLiwNpwHvA2sD8R2xsLO9bef/880+0bt0ajRo1AgCMGDECYrEY//zzD7Kysnjz1aZNGyQnJyMnJ4cTfW9vb+Tk5OD+/fuc6LOJNjD/cffuXTRt2pRXD1u3bq0cVQDAwsICvXr1QllZGbZt28abL2dnZxARZ3/Qtra2AMDrh0J10QbmP3JycmBubs5b/atXr+LWrVsYMGDAC1+vCNDWrVv5sAUAlb+X7OxsTvTNzMwAPLslVXe0fcn+o6ioqHKDFB9s2bIF+fn5r91sde3aNZw7dw4+Pj4qdoZKT4WFhZzo6+npcarPJtoR5j9MTU3x+PFjXmqXlpZi+/btOH36NOjZUv8L/2bOnAmAv1Gm4pO/YiRgm4KCAgCAgYEBJ/psog3Mf1hYWODRo0e81D5w4AAsLCzQpk2bKr8/btw4AMCOHTtQXFysSmsAUPl7sbCw4ES/YjHB1NSUE3020QbmP9zc3HDp0iVeam/duhVjx4597ffd3d3h4+ODp0+f4q+//lKhs2fEx8dDKpWicePGnOgnJycDAJycnDjRZxNtYP6jTZs2OHv2rEqfBaSmpoJhGBw8eBBz5szBBx988MrP3L17FwzD4Ny5cwCeLTVbW1urzCMAnD17Fl5eXpBKpZzox8fHw8HBASYmJpzos4k2MP/RpUsXZGdn4/Tp0yqraW9v/8JcJTY29pWfadiw4StzmoyMDJV5LCsrw4EDB9ClSxfOakRGRqJz586c6bOJNjD/0bx5c8hkMt6fqqsb4eHhePjwIUaNGsWJfmpqKmJiYtC7d29O9NlGG5jnGD9+PEJDQ5Gens63FbVh9erV6Ny5M2fzl+DgYJiZmWlMYLRvKz9HcXExNWjQgMaPH8+3FbXg0KFDBICio6M50c/MzCRDQ0NaunQpJ/pcoA3MS2zbto2EQiHFxcXxbYVXioqKyNXVlfr27ctZjcGDB5ODgwMVFhZyVoNttIF5CaVSST179qTGjRvT06dP+bbDG1OmTCETExO6c+cOJ/qbNm0ihmEoIiKCE32u0AamCh4+fEiWlpY0aNAgznYaqjPbt28nhmEoLCyME/2DBw+SWCymr776ihN9LtEG5jUcP36cpFIpTZs2jW8rKiUiIoIkEslbt0YXFRW9U4fMP/74gyQSCY0bN04j2+5qA/MGdu/eTUKhkObMmaOR/3NrSmRkJBkYGNDIkSNfud68vDw6fPgwzZ8/n3x9fUksFtPEiROrrV1YWEhTp04lABQYGKixv09tYN7Ctm3bSCwW08iRI3ltjsE1FZ/8w4YNI4VCQTk5ObRv3z6aNWsWeXp6klAoJACko6NDDMOQUCikRYsWvVW3vLycwsLCqEGDBmRiYkKhoaHcXwyHaANTDSIiIsjQ0JDatWtH9+7d49sOqygUCpo9ezYxDEP9+vWjuXPnkoeHBzEMQwBIIpFUeYiSSCSi4ODg1+rm5+fTpk2byN3dnQQCAY0YMUJj+yk/jzYw1SQhIYFcXV3JzMyMdu/ezbcdVggNDSVLS8vKcDAM89qAVPXv5RMNrl27RqtXr6aePXuSvr4+6ejo0MiRIykxMZGnK2QfbWBqQGFhIU2YMIEAUJ8+fThbcuWa4uJiWrx4MUkkErK1tSVXV9fKUaO6YQFAo0ePpsGDB5OPjw+Zm5tXHt83cOBACg4OpuzsbL4vlXW0gXkHjh07Ri4uLqSnp0dffvmlxjShKysro5CQEGrcuDEZGhqSu7s76erq0m+//UbR0dHUvXt3YhiGxGJxtQLj5uZG/fr1o8DAQFq3bh2dO3eOysrK+L5MTtEG5h1RKBS0cuVKsrS0JAMDA5o3bx6rp3exSVFREW3evJmcnJxIJBLRmDFjKDU1lcrKymjRokUkEAho5MiRVFRURFeuXKHhw4eTUCh8Y3AYhtG4zvtsoA3Me1JQUEA//vgjWVtbk1AopD59+tDBgwfVYkUtISGBZs6cSaampiSRSGj06NFVPjvZv38/mZiYUMuWLSklJYWInp3jMn36dJJKpVUGx8zMTNWXoxZoA8MScrmcQkNDyc3NjRiGITMzMwoICKB9+/ZRfn6+SjyUlZXR+fPnaf78+dSsWTMCQI6OjrRs2bK3niiWnJxMHh4eZG5uTuHh4ZVfz8rKooULF5KRkVHl0jIAcnV15fpy1BJtYFhk165dxDAMBQcH04oVK6hNmzYkEAhIJBKRj48PBQYGUlhYGF2/fp2V25nU1FSKiIigpUuXUo8ePcjIyIgAUMOGDWnWrFkUExNTo1d7CgoKaPjw4SQQCGjp0qUvPFzMz8+noKAgsra2JgD00Ucfvbd/TYQh0oD+nBpAcnIyvL29MXLkSKxbt67y65mZmTh58iSio6Nx4sQJJCUloby8HBKJBM7Ozqhfvz6sra1hb28PIyMjGBoaQiQSwdDQEHK5HEVFRZDL5Xj69CkyMzORmpqKjIwM3Lx5s7LLjZ2dHdq1a4cOHTqgQ4cOcHd3f69r+emnnxAYGIihQ4di06ZNL2xNLi0txZ9//onMzEzMmTPnvepoItrAsEBBQQF8fX1haGiIkydPvnHve0lJCZKSknDt2jXcuHGjMgBpaWnIy8tDfn4+SktLUVBQALFYDAMDA+jo6MDQ0BBWVlaws7ODtbU1nJyc4ObmBnd3d04aEEZGRsLf3x8uLi7Yu3cvrKysWK+hkfA7wNUO/P39ydLSktVVMgC8v0aSnJxMTZs2JXt7e4qPj+fVi7qg3aL8ngQFBWHPnj3YsWMH7O3t+bbDKk5OTjhz5gycnJzQoUMHHDhwgG9LvKMNzHtw7tw5zJ07F999953GdD2pKWZmZjhy5AhGjhyJfv36Yfny5Xxb4hVtb+V35OnTpxgyZAg6d+5c6ye/IpEIGzZsQNOmTTFr1iykpaVh9erVEAjq3uetNjDvyJQpU1BUVITffvutzvzhzJgxAw0aNMDQoUORm5uLrVu3QiwW821LpdSN/9Ms8/PPPyM0NBR//PGHyrtQ8s0nn3yCQ4cOYf/+/ejXrx+Kior4tqRStIGpIYmJiQgMDMSCBQvQtWtXvu3wgp+fH44dO4Zz586hc+fOnJ1Mpo5oA1MDioqKMGjQIHh5eeHrr7/m2w6veHl54dSpU0hPT0fHjh2RlpbGtyWVoA1MDZgzZw4yMjKwfft2iETa6V+zZs0QGxsLgUCAdu3a4datW3xb4hxtYKpJZGQkNmzYgA0bNvB60rK6YWtri2PHjqFevXro2LEjbt68ybclTtEGpho8fvwYY8eORf/+/TF06FC+7agdFhYWiIqKQsOGDdGlSxfcvn2bb0ucoQ1MNZg8eTKICL/88gvfVtQWQ0NDHD58GHZ2dvDz80NKSgrfljhBG5i3EBISgl27duHXX3/l7IzH2oKRkRGOHDkCGxsb+Pn54c6dO3xbYh1tYN7AgwcPMGPGDMyYMQPdu3fn245GYGxsjCNHjqBevXrw8/PD3bt3+bbEKtrAvIHJkyfD2toay5Yt49uKRmFiYoLDhw/DyMgI3bp1q1VLztrAvIZt27bh8OHD2LRpE3R0dPi2o3FYWFjg6NGjEIvF6NKli0qPGeQSbWCqIDs7G4GBgfj000/Rvn17vu1oLJaWloiKigIRoUePHsjLy+Pb0nujDUwVTJ06Fbq6uli6dCnfVjQeGxsbREVF4dGjR+jbty/kcjnflt4LbWBe4uDBgwgLC8O6detgaGjIt51agb29PQ4dOoTLly8jICAASqWSb0vvjDYwz/H06VNMmjQJI0eO1JxDSjWE5s2bY8+ePdi7dy/mzp3Lt513RhuY51i4cCFKS0sRFBTEt5VaSefOnbF582asXLlSY493175B+B+JiYn4+eefsXHjRk66sGh5xogRI3Djxg1MnjwZjRo1gp+fH9+WaoS2zRIAIoKfnx+Kiooq377lG4ZhEBoaCn9/f76tsA4RYdiwYThy5Aji4uLQpEkTvi1VG/7/MtSAkJAQREdHY926dWoRltoOwzDYvHkzGjZsiP79+6OwsJBvS9Wmzv915OXlYf78+ZgyZQp8fHz4tlNn0NPTw99//42MjAyMHz+ebzvVps4HZsGCBVAoFFiyZAnfVuocDg4O2LFjB3bt2oW1a9fybada1OnAJCQk4Oeff8aPP/6onejzRJcuXbBkyRIEBgbizJkzfNt5K3V60t+jRw88fPgQFy9eVLu5S22e9L8MEaF3795ITEzE5cuXYWJiwrel16JefyUq5OTJkwgPD8ePP/6odmGpazAMg61bt0KhUGDChAl823kjdfIvhYgwb948fPTRR3W2VZK6Ua9ePYSEhGDPnj0ICQnh285rqZMPLnft2oVz587h/PnzfFvR8hzdunXD559/jmnTpqFdu3Zo3Lgx35Zeoc7NYUpLS+Hm5oYPPvgAv//+O992XktdmsM8j1wuh7e3d2VjDYZh+Lb0AnXuliw4OBj37t3D4sWL+baipQqkUilCQkIQExOjlk1H6tQIU1xcDEdHRwwdOhSrVq3i204lo0aNwqVLl174WnJyMmxsbF7YYiAWi3Hw4EHY2tqq2qLKmTdvHn7++WckJCSgfv36fNv5H3yc4sQXa9euJR0dHUpPT+fbygt89913rxzrXdW/unRycXFxMTVt2pR69uzJt5UXqDOBUSgU1LBhQ/rss8/4tvIKd+/eJYZh3hgWsVhMP/zwA99WVcqJEyeIYRjat28f31YqqTOB2bJlC4nFYrpz5w7fVqqkVatWbwwNwzBq651LhgwZQo6OjlRcXMy3FSKqI2dcKpVKLF++HCNGjEDDhg35tlMlo0aNglAorPJ7AoEAvr6+auudS1asWIGsrCysWLGCbyvP4DuxqiA0NJSEQiHduHGDbyuvJTMzkwQCQZWji0gkog0bNvBtkTeWLVtGenp6dP/+fb6tUJ1YJWvVqhWcnJywc+dOvq28kc6dO+PUqVMoLy9/4etCoRDp6emwtLTkyRm/yOVyuLi4oHPnzvj111/5NcN3YrkmMjKSANClS5f4tvJWtmzZ8sooIxQK6aOPPuLbGu/89ttvJBQKKSkpiVcftX6EGThwILKysnDq1Cm+rbyVvLw81KtXDwqFovJrAoEAISEhGDFiBI/O+Ke8vBweHh5o0aIF/vzzT/6M8BpXjklPTyexWEx//PEH31aqTd++fUkkElWOMBKJhJ4+fcq3LbVgz549JBAI6PLly7x5qNWrZJs2bYKxsTEGDBjAt5VqM2LEiMo5jEgkQt++fWFkZMSzK/WgX79+aNGiBf7v//6PNw+1NjDl5eXYsmULxo4dq1HNxHv16gU9PT0Az65h+PDhPDtSHxiGwRdffIFdu3bxdmBTrQ3MP//8g/v372tUgwUA0NHRQf/+/QEA+vr62nNpXsLf3x/29vb46aefeKlfa/fDbNy4Ed26dYOTkxPfVt5Kbm4uHj58iCdPnqC4uLiyT5evry+io6MhFAphYmICKysrWFlZvfYBZ11AJBJhxowZWLhwIRYuXKjyXgy1cpUsLS0N9evXR1hYmNrMX4gI169fR3x8PBITE5GYmIibN28iLS0NJSUl1dYRCoWwsrKCo6Mj3N3d4e7uDg8PD3h7e2vUref7kJ+fDwcHB3z99deYNWuWSmvXysCsXLkS3333HTIyMiCVSnnzce/ePRw4cADHjh1DdHQ0srOzIZVK4eLiAjc3N7i4uMDBwQE2NjawtbWFmZkZdHR0IJVKERQUhMDAQBQXF0OpVCI3NxeZmZlIT09Heno6bt68ievXryMxMRG5ubmQSqXw8fFBp06d0KNHD/j6+qrd5is2mTJlCk6cOIHr16+r9jp5W5/jkJYtW9L48eN5qZ2amkrff/89tWrVigCQsbEx9enTh1atWkUXLlyg0tLSaulU9+eInr3tHBISQuPGjSNHR0cCQHZ2djR16lQ6c+bMu16KWnP+/HkCQKdPn1Zp3VoXmKSkJAJAUVFRKqupVCopIiKCPvnkExKJRGRhYUETJ06k8PBwksvlKvNRwdWrV2nJkiXk4eFBAKhFixa0YcMGys/PV7kXLpHJZDR27FiV1qx1gfn666/JxsaGysrKVFIvMjKSvL29CQC1atWKgoODqaioSCW1q8OFCxdo4sSJpK+vT+bm5rRo0SJ68uQJ37ZYYe3ataSvr6/SB7u1bg7j4uKC7t27c37GS1xcHD777DNcvHgRffv2xaJFi+Dp6clpzfchOzsbq1atwrp16yCVSvHdd99hwoQJb+zJ9uTJE2RmZiI7Oxs5OTmVx+0JhUJYWFjA3NwclpaWqFevnqou4xV/tra2WLNmjer6maksmirg+vXrBIBOnTrFWY3Hjx/TpEmTSCAQkJ+fn0a81Pk82dnZFBgYSGKxmHx8fOjixYukUCgoNjaWVq9eTaNGjSJfX18yMzOr1rZpAGRmZkbt27enqVOn0u7duyknJ0dl1zNkyBDq1KmTyurVqhFm2bJlWL16NdLT0zl5VnH69GkMGzYMCoUCK1as0Oin8ImJifj0008RGxsLU1NTZGVlwdzcHF5eXmjWrBmcnZ3h6OgIGxsbmJubw9zcHLq6ugCetarKyclBTk4OsrKykJSUhISEBFy8eBHx8fEgIrRv3x5jx47FgAEDoK+vz9l17N27FwMHDsSDBw9U0xxEZdFUAT4+Ppytji1btoxEIhH16tWLHj16xEkNVaNUKmn58uUkEomoffv2lJub+96aubm5tHv3burfvz9JJBIyMTGhb775hvLy8lhw/CrFxcVkZGREa9eu5UT/ZWpNYFJTU4lhGDpw4ACrumVlZTRx4kQSCoUUFBRESqWSVX11IDY2luzt7cnd3Z0ePHjAmu6jR49oyZIlZGxsTBYWFpy9NT5s2DDq0KEDJ9ovU2sCs3HjRtLX12e1WUJpaSn169eP9PT01KpzCRfcv3+f3NzcyMHBgW7fvs2qdm5uLk2bNo0YhqGBAweyvkq3d+9eEggElJaWxqpuVdSawPTt25d69+7Nmp5SqaSAgADS19enmJgY1nTVmdzcXPLy8qLGjRtTRkYG6/pHjx4lW1tb8vT0pIcPH7Kmq8rbsloRGIVCQUZGRrR+/XrWNBcsWEASiYQOHz7MmqYmkJWVRc7OztSyZUtOWhvduXOHnJ2dycnJidW54MCBA+njjz9mTe911IrAHDt2jACwditx9OhREggEtGnTJlb0NI1///2XTExMaOrUqZzoZ2ZmUsOGDcnPz69GrwC9iV9//ZV0dXWpsLCQFb3XUSsCM3fuXHJ2dmZFKzc3l2xtbcnf358VPU0lNDSUGIahgwcPcqJ/+fJl0tfXp4ULF7Kil56eTgzDUHh4OCt6r6NWBMbT05OmTZvGilZgYCBZWlrS48ePWdF7G/r6+q99IKirq0seHh60cuVKlb3q8zxDhw4lJycnUigUnOivWrWKpFIp3bp1ixU9Dw8PmjFjBitar0PjA5OTk0MCgYD+/vvv99ZKSUkhqVTK6lyoOly6dIkAUN++fSu/lpeXRydPnqx8gfLzzz9XqSeiZ29B6+jocDaZVigU1KxZMxo+fDgrenPmzKGmTZuyovU6ND4wf/31FwkEAsrOzn5vrc8//5waNWrE2Sfq66gqMBWcOXOGAJCenp7KfRERTZ8+nRo1akTl5eWc6G/ZsoUkEgkrCwDHjx8nAJz2oNb4Pf0nTpxAixYt3nuramlpKf744w+MHTsWYrGYJXfvT9OmTQEARUVFePr0qcrrT5kyBXfu3MGJEyc40ff394eOjg4rvcZat24NHR0dTnvQ1YrA+Pn5vbdOVFQUsrOzERAQwIIr9rh58yaAZ4emWlhYqLx+s2bN4Ovry1nzPH19ffTo0QMRERHvrSWVSuHl5YXTp0+z4KxqNDowOTk5SExMRMeOHd9bKzo6Gk2bNoWDgwMLzt6fgoICREdHY/LkydDT08PGjRt589K1a1fExMRwpv/BBx8gLi4OxMJ7wO3atUN0dDQLrqpGowMTGxsLIkLbtm1Z0WrdujULrt6dffv2gWEYMAwDQ0NDdOjQAXK5HNu2batsvcQHbdq0QXJyMnJycjjR9/b2Rk5ODu7fv//eWm3btsWNGzfw6NEjFpy9ikYHJi4uDk2aNGGl1c7du3cr5wt80bdvX9CzhRiUlpYiJSUFQ4YMwcCBAzFgwACUlpby4svZ2RlExMofdFVUvJaflZX13lpt27YFwzA4c+bMe2tVhUYH5ty5c/D19WVFKycnR+U9rt6ESCRCo0aNsHjxYgwbNgx//fUXb83rKn4v2dnZnOibmZkBeNaf7X0xNTWFm5sbZ/MYjQ0MEeHChQvw9vZmRa+oqKhyg5S60aFDBwDPFib4oGIDWGFhISf6Fa1x2dL38vJ65VRqttDYwNy6dQs5OTmsjTCmpqZ4/PgxK1psUzEZLioq4qV+xSd/xUjANgUFBQAAAwMDVvQ8PT21gXmZc+fOQSKRsNZ4wsLCgrOJ4vtSserD1mhaUyp+L1wta1csJpiamrKi5+npiZycHDx48IAVvefR2N7K586dQ4sWLVjrbOnm5sbZp9K7UFZWhtTUVPz222/4888/YWdnp/K2qBXEx8dDKpWicePGnOgnJycDAGt9sD09PcEwDC5fvsz6YwKNHWHi4uJYux0Dni2dnj17lpVnATXBwMAAMpkMwIvLyhKJBB4eHvj7778xe/ZsxMfHw8bGRqXeKjh79iy8vLw4a7sbHx8PBwcHmJiYsKJnZGQER0dHTj4ANTIwCoUCV65cgY+PD2uaXbp0QXZ2NqdPiauioKCgcin5+X9KpRJ5eXm4fPkyli9fztuBsGVlZThw4AC6dOnCWYpcDLYAACAASURBVI3IyEh07tyZVU1PT09cuXKFVU1AQwNz+fJlyOVyVgPTvHlzyGQybNmyhTXN2kB4eDgePnyIUaNGcaKfmpqKmJgY9O7dm1VdFxeXyls9NtHIwFy4cAHGxsZwdnZmVXf8+PEIDQ1Feno6q7qazOrVq9G5c2fO5i/BwcEwMzNjPTBOTk64devWK0e4vy8aGZiEhAQ0b96c9WMOxo4di3r16mHRokWs6moq4eHhOHbsGBYvXsyJflZWFtasWYPPP/8cEomEVW1nZ2fI5XL2307gbOMAh7Rv354mTZrEifa2bdtIKBRSXFwcJ/qaQlFREbm6ula5R4ctBg8eTA4ODpzsw8/NzSUArDcx0cjAWFhY0E8//cSJtlKppJ49e1Ljxo3r9HHfU6ZMIRMTE842Y23atIkYhqGIiAhO9Im4+TvRuMA8fPiQ8/NfHj58SJaWljRo0CDOdhqqM9u3byeGYSgsLIwT/YMHD5JYLKavvvqKE/0K2rZty1qvhwo0LjBHjx4lAJw0mnue48ePk1QqZf0Xru5ERESQRCKhL7744o0/V1RU9E5trf744w+SSCQ0btw4ztvuDh06lPVbSo0LzJo1a8jc3FwltXbv3k1CoZDmzJlTK3sqv0xkZCQZGBjQyJEjX7nevLw8Onz4MM2fP598fX1JLBbTxIkTq61dWFhIU6dOJQAUGBiokt/n7NmzycvLi1VNjQvMxIkTVdZ4mujZIoBYLKaRI0fy0oRCVVR88g8bNowUCgXl5OTQvn37aNasWeTp6UlCoZAAkI6ODjEMQ0KhkBYtWvRW3fLycgoLC6MGDRqQiYkJhYaGcn8x/7F69WqytrZmVVPjAtO2bVuaMmWKSmtGRESQoaEhtWvXju7du6fS2lyjUCho9uzZxDAM9evXj+bOnUseHh7EMAwBIIlEUmXPNJFIRMHBwa/Vzc/Pp02bNpG7uzsJBAIaMWIEq/2Uq8Pu3btJIBCwes6oxgXGzMyM1q1bp/K6CQkJ5OrqSmZmZrR7926V1+eC0NBQsrS0rAwHwzCvDUhV/14+0eDatWu0evVq6tmzJ+nr65OOjg6NHDmSEhMTebm+2NhYAkB3795lTVOjApOWlkYA6Pjx47zULywspAkTJhAA6tOnD6f9r7ikuLiYFi9eTDo6OtSwYUNydXWtHDWqGxYANHr0aBo8eDD5+PiQubl55fF9AwcOpODgYFZ6xb0PDx48IACsnr6gUYGJiopSyQrZ2zh27Bi5uLiQnp4effnllxpzIllZWRmFhIRQ48aNydDQkFasWFE5L4uOjqbu3bsTwzAkFourFRg3Nzfq168fBQYG0rp16+jcuXO8tLR9HXK5nADQ3r17WdPUqMBs2rSJ9PX1+bZBRM/u/VeuXEmWlpZkYGBA8+bNY/X0LjYpKiqizZs3k5OTE4lEIhozZgylpqZW+bNXrlyh4cOHk1AofGNwGIZhrfM+lxgYGNDmzZtZ09OowMyfP5+aN2/Ot40XKCgooB9//JGsra1JKBRSnz596ODBg2qxopaQkEAzZ84kU1NTkkgkNHr06Go/O7lz5w5Nnz6dpFJplcExMzPj2D07NGjQgH744QfW9DQqMEOHDqU+ffrwbaNK5HI5hYaGkp+fHzEMQ2ZmZhQQEED79u2j/Px8lXgoKyuj8+fP0/z586lZs2YEgBwdHWnZsmXvfBublZVFCxcuJCMjo8qlZQDk6urKsntukMlkNG/ePNb0NCowvr6+NHPmTL5tvJWUlBRasWIFtW7dmhiGIZFIRD4+PhQYGEhhYWF0/fp1Vm5nUlNTKSIigpYuXUo9evQgIyMjAkANGzakWbNmUUxMDGuv9uTn51NQUBBZW1sTAProo49Y0eWarl271ugB69vQqD39d+7cwbBhw/i28VYaNWqEwMBAlJSUID4+HmvWrEFiYiIiIiKwevVqlJeXQyKRwNnZGfXr14e1tTXs7e1hZGQEQ0NDiEQiGBoaQi6Xo6ioCHK5HE+fPkVmZiZSU1ORkZGBmzdvVna5sbOzQ7t27bBs2TJ06NAB7u7urF+TgYEBZs6cialTp+LPP/9EZmYm6zW4wNzcnNWOnQyRijexvyOFhYUwMDDA/v37Wd9sxAU3btyATCbDN998g9mzZ1d+vaSkBElJSbh27Rpu3LhRGYC0tDTk5eUhPz8fpaWlKCgogEQigb6+PnR0dCAUCqGjowMvLy9YW1vDyckJbm5ucHd3V6sGhOrG+PHjkZqaisOHD7OipzEjTEpKCgDA0dGRZydvR6lUYty4cfDw8Hil04uOjg5kMlll44vq8v3332PTpk3YsWMHm1ZrPbq6uiguLmZNT2MCc+fOHQBAgwYNeHbydlauXIkLFy7g4sWLEAqFrGh6enri3r17yM3N5ayhXm1ET0+P1QaIGrNFOSUlBVZWVqx1R+SK5ORkLFq0CAsXLmR1LlExIl2+fJk1zboA2yOMxgTmzp07aNSoEd823ohSqcSECRPg7OyMuXPnsqpta2sLKysrbWBqSJ29JUtNTUX9+vX5tvFG1q9fjzNnziA2NpaTY/+47BlcW9HV1a2bt2QPHz7krfNjdbh79y7mz5+PefPmoVWrVpzU8PT01I4wNUQikUChULCmpw0MCxARJk2aBHt7eyxYsICzOjKZDElJSbx18deiQYHJzMxU28Bs2rQJR48exebNm6Gjo8NZHZlMhvLycly7do2zGrUNhmFY7ZetEYF5/PgxiouL1TIw6enpmDt3LgIDA9GmTRtOazVp0gQGBgbaeUwNqJOBefjwIQCoZWCmTJkCS0tLLFmyhPNaAoEAHh4e2nlMDWA7MBqxSqaugQkJCcHBgwdx/PhxlR33J5PJcPHiRZXUqg3U2RFGIpGo1RPujIwMzJo1C1OnTq08g1IVeHp64urVq6w32a6tEBGrPbg1JjA2NjasNx9/H6ZOnQojIyMsXbpUpXVlMhmKiopw69YtldbVVORyOasHQWlUYNSF0NBQ7N27F8HBwSp/Vcfd3R1isVg78a8mJSUldS8wWVlZvJ3A9TLZ2dmYPn06JkyYgA8//FDl9aVSKVxcXLQT/2pSJ0eY3NxctdnzMW3aNIhEIixfvpw3D9pXZKqPXC5n9dmYxgRGHSb8Bw8exM6dO/Hzzz+zdoDpuyCTyRAfH89bfU2izo4wbJ3h/q48ffoUkydPRkBAAPr06cOrl4pz6FNTU3n1oQmUlJRoRxg+mDFjBsrLy7Fq1SpefQAvnkOv5c3k5eXByMiINT21D4xSqcSTJ094DczRo0fx+++/Y/369bwHFwBMTEzQsGFD7TymGjx9+hTGxsas6al9YJ4+fYry8nLe/lDz8vIwbtw4+Pv7o3///rx4qAqZTKYNTDWocyNMbm4uAPAWmDlz5qCoqAg//fQTL/Vfh3ZvTPXIy8urWyMMn4E5fvw4fvnlF6xdu1ZtngNVIJPJcPfu3creZFqqRjvCqIiioiJMmDABPXv2xJAhQ1Rauzp4enqCiHDlyhW+rag1dW4Ok5eXB4ZhWP2UqA5ffvklsrOzsXHjRpXWrS729vawtLTUzmPeABEhOzsb9erVY01T7V/vLygogL6+vkpfvDx79izWr1+PzZs3w87OTmV1a0qLFi2085g3kJOTg7KyMlZvp9V+hCksLIS+vr7K6snlcowfPx5+fn4YNWqUyuq+C9qVsjeTlZUFAHUrMBUjjKpYuHAhUlNTsXnzZrXaTlAVnp6eSEpKQklJCd9W1JI6GZiKJuSq4NKlSwgKCsKPP/6o9j3QgGcjTFlZmbYpxmvIysqCQCBg9cVdjQiMKkYYhUKBUaNGoX379pgwYQLn9djA2dlZ2xTjDTx69Ajm5uas9bcGNGjSzzXffvstUlJS8Pfff6v9rVgFAoEA7u7u2on/a0hNTWV90UbtA6OKW7IrV65g+fLlWLFiBRo3bsxpLbbRTvxfz4MHD+Dg4MCqploF5tGjR8jPzwfw7BwVXV1dPH78GAYGBigrK4NIxL7dsrIyjBs3Dl5eXpg6dSrr+lzj6emJ33//HUqlEgKB2t9hq5TU1FS4urqyK8ra4X8ssGrVqmqdDw+AduzYwUrNb7/9lqRSKV27do0VPVVz7tw5AkA3btzg24ra4ejoSEuXLmVVU60+kgYMGFCt+YNUKkXPnj1rpD116lRkZGS88LUbN27g+++/x7fffsv+J5GKaN68OcRisXYe8xJEhPT0dNjb27Oqq1aBqV+/PmQy2RtDIxaLMWDAABgaGlZb99atW9iwYQOaNm2Kbdu2AXi2z2b8+PFVHqunSejo6KBp06baecxLPHr0CCUlJawHRq3mMAAwdOhQXL16FWVlZVV+v7S0FGPGjKmR5smTJyEUCpGXl4eAgABs374dXl5eOH/+PKvH6vGFTCbTjjAv8e+//wJg/0xUtRphAGDgwIFv7OpoaWkJPz+/GmkeP368ctQiIhw7dgwrVqxA7969NfZW7Hm0XWRe5ebNm9DV1WV9lUztAtOwYUN4eHhUeVsmFosxduzYGo8IkZGRL4xYpaWlkMvl+Ouvv9C+fXuN7yIpk8mQlZWF9PR0vq2oDbdu3UKTJk1YXzlUu8AAz27LqgpFaWlpjV+IvH37Nh49elTl94gI586dg4eHB9atWwelUvlOfvmmYt6nHWX+R3JyMpydnVnXVcvA+Pv7v3JbxjAMZDIZXFxcaqR14sSJN45IZWVlkMvlmDdvHmJjY9/JL9+YmJigfv362nnMc9SpwDRq1OiVI7uFQiHGjx9fY63n5y9VIRKJ4OjoiLi4OM4PROIS7RP//0FEuH37NpycnFjXVsvAAM9uy15+su/v719jnZfnL8/DMAz8/f1x5coVuLm5vZNPdUHbFON/PHjwAEVFRWjatCnr2mobmIEDB1b+oYtEIvTs2RMWFhY10rh161aV8xeRSASxWIygoCBs375dpfttuEImkyElJQVPnz7l2wrvJCcnA0DduSUDACcnp8ol3/Ly8ho/ewGqnr+IRCLUq1cPMTExmDFjBite1QGZTKZtivEfycnJMDU1rfEHbHVQ28AAz27LAMDY2Bg9evSo8X9/4sSJF+YvAoEAH374Ia5duwYfHx/WfKoDDg4OsLCw0M5j8OzOgovbMUDNnvSXl5cjMzMTmZmZePLkSeVehtatW+PIkSOQSqXQ1dWFiYkJbGxs3tp6KSoqCmVlZRAKhSAiLFy4EF9//XWtfatX2xTjGVytkAE8Baa4uBjnz5/H1atXkZiYiGvXruHff/9FVlZWlU/5w8PDER4e/srXdXR0YG9vj6ZNm8Ld3R1ubm5o2bIlXF1d8e+//yIzMxMMw8DMzAx79uxB+/btVXF5vCGTyRAZGcm3Dd5JTk5G69atOdFWSWCUSiXi4uJw6NAhnDhxAufPn4dcLoeZmRnc3d3RvHlzDBw4EDY2NrC1tYWVlRXMzMwgEAhw9OhRDBo0CEVFRZDL5SgpKUFubi7S09Px8OFDPHjwANevX8fhw4cRFBQEhUKBevXqVb4S4ePjg3379sHKykoVl8ornp6eWLNmDetHPGgSBQUFSElJ4e6VJ1Y3C7xETEwMTZkyhWxtbQkANW7cmMaNG0e///473bt3j/V6paWldP78eVq5ciXZ29uTVColhmHIy8uLli1bRmlpaazXVCeuXbtGAOjixYt8W+GNU6dOEQC6e/cuJ/qsByY/P5/Wr19PzZs3JwDk4eFBS5YsoatXr7Jd6o1cunSJ5HI5hYeH08SJE8nCwoJEIhH169ePjhw5olIvqqKsrIz09PRo8+bNfFvhjdWrV5O5uTln+qwFJj8/n1avXk3W1tako6NDgwYNosjISLbk3xu5XE5hYWHUtWtXYhiGPDw8KCwsjJRKJd/WWMXX15c+++wzvm3wRkBAAHXr1o0z/feewyiVSgQHB2PhwoUoLS3F9OnT8fnnn6vFwUPPI5FIMGjQIAwaNAjx8fFYsmQJBg8eDG9vb6xbtw7e3t6v/W+VSiUyMjKQk5ODnJwcZGdng4gAALq6urCwsIC5uTns7Oygp6enqkuqkrr+xD8+Pv6dHkFUm/dJ28WLF8nb25vEYjF98cUXlJOTw1KOVUN8fDx16tSJBAIBTZ48mR4/fkw5OTl06NAh+vrrr+mTTz4hV1dXkkql1eozwDAMNWrUiHr27EmLFy+m6OhoUigUKr2mjRs3koGBAZWXl6u0rjpQXFxMYrGYQkNDOavBEP33UVmzkOHHH3/EV199hdatW2PDhg0a+y4WEWH79u2YPXs2GIZBRkYGiAhOTk6QyWRwcnKCs7MzGjVqBHNz88rRpOINgqKiospR5/79+7h+/ToSExMRExOD+/fvw9DQEAMGDMDYsWPRrl07znuexcXF4YMPPkBycjInLx+qMxXXXrEXhhNqmrDc3Fz68MMPSSwW0w8//FBr5gCPHj2iHj16kFAopEWLFrGimZycTGvWrKGWLVsSAGrevDnt3buX099ZUVERiUQiTj9l1ZUNGzaQkZERp7/fGgXm/v375ObmRg4ODnTu3DmuPPGGUqmklStXklAopClTplBZWRlr2pcuXaJBgwYRwzDk6+tL169fZ037ZVxdXenLL7/kTF9dGT9+PHXq1InTGtUOzK1bt8je3p6aN29OqampXHrinb1795Kuri4NHDiQSktLWdW+dOkS+fr6kq6uLv3000+salcwfPhw6t69Oyfa6kzLli1p1qxZnNaoVmDS09PJ0dGRfHx86PHjx5waUhdOnTpFenp6NHbsWNaH+NLSUvrmm29IIBDQzJkzWdf/8ccfydLSklVNdUcul5NUKqVt27ZxWuetgSksLKQWLVpQs2bN6NGjR5yaUTf++ecfEovFrM1pXiY0NJSkUilNmjSJVd2jR48SAHr48CGruupMfHw8AaDExERO67w1MJMnTyZTU1POXjVQdzZu3EgCgYCOHz/Oif7+/ftJIBDQ2rVrWdPMzs4mAHTo0CHWNNWd9evXk5GREavzzqp4Y2D2799PDMPQ7t27OTWh7gwcOJDs7e05ux39/vvvSSQSUXx8PGua9evXp++//541PXVnyJAhKpm3vTYwcrmcGjduTMOHD+fcRFWcO3eOAgICqGHDhqSjo0Ompqbk5uZG/fv3pw0bNtDt27dV5iU3N5fq1atHs2fP5kRfqVRS+/btqU2bNqzNZ/r06UODBg1iRUsTcHBwUMkHxGsDExQURLq6unT//n3OTTxPeXk5ffHFFyQSiWj27NmUlJREJSUllJGRQUeOHKGuXbtWPllnewXrTfz000+ko6PD2a3p+fPnSSAQ0N9//82K3qJFi6hJkyasaKk7d+7cIQB08uRJzmtVGZjy8nKqX78+50t0VTF//nwCQL/88kuV3y8rK6OPP/5Y5YGRy+VUv359zkYZIqKPP/6YevTowYrW3r17iWEYevr0KSt66szvv/9OUqmUioqKOK9VZWAiIiIIACUlJXFu4HmSkpJIIBBQq1at3vhzZ86cUXlgiJ59altZWXH2ftju3btJKBSy8pzr7t27BICio6NZcKbeTJw4kdq2bauSWlVubt+5cydat26NZs2acfM+zmv45ZdfoFQqMWjQoDf+XOvWrUFEnJxI9ibGjBmDrKwsHD9+nBP93r17QyKR4OjRo++t1aBBA5iZmdWJphjR0dEq235eZWCio6PRrVs3lRh4nlOnTgEAPDw8VF67OjRo0ABNmjRBTEwMJ/oSiQQtW7ZEXFwcK3p14VX/7Oxs3LhxA+3atVNJvVcCk52djX///ZezJgJvoqL7PJvnqrNNmzZtcPbsWc70vb29cfHiRVa06sIxGKdPnwbDMCr7e30lMPfu3QMRcdbXqTqo87Hfzs7OuHv3Lmf6NjY2yMrKYkVLJpPh2rVrUCgUrOipIzExMXB3d1fZhsUqRxiAn095W1vbFzyoI+bm5sjJyeFM38zMDI8fP2ZFy9PTEwqFAtevX2dFTx2Jjo5W2e0YUEVgiouLATzbeqtqOnbsCAC4evWqymtXFwMDAxQWFnKmr6enx5q+i4sL9PT0au08prCwEPHx8fwGxtTUFABY+5SrCZMmTYJIJMLu3bvf+HNz5syBQCDAjRs3VOTsf+Tk5HA6/BcUFMDAwIAVLaFQCDc3t1o7jzl+/DjKyspqfITj+/BKYCpuxV53aheXODs7Y9GiRbhw4QK2bNlS5c/cvHkTwcHB8Pf3V/myN/Ds98Ll7WpOTk7lhxYb1OZzY44cOQJPT09YW1urrOYrgXFycoKOjg5vv+SvvvoK8+bNw+TJkzFv3jwkJydDoVAgLS0Nmzdvhp+fHzw8PLB582Ze/MXHx6N58+ac6bO9F9/T0xNXrlyp7HJTmzhy5Ag+/PBDldZ8JTBSqRQymQxnzpxRqZHnWbZsGU6fPo309HR07doVBgYGcHFxwa+//op58+YhKiqKlzNdiAixsbGcLmHGx8e/cvra+yCTyZCXl4eUlBTWNNWBe/fu4ebNmyoPTJWvxnz11Vdkb2/P+d4CTePEiRMEgBISEjjRz8jIIIZh6ODBg6xpFhYWklAopF27drGmqQ4EBweTvr4+lZSUqLRulU/6x4wZg7S0NG0n+JfYvHkzvL29WR0Bnmfnzp0wMDBAp06dWNPU09ODk5NTrVspO3LkCDp16gSpVKrSulUGxtHRER06dEBQUJBKzagzqamp2L179zsdTFsdysvLERwcjCFDhrB+u1nbJv7l5eU4fvw4L69vvXY/zMmTJwkARUREqHLEU1tGjx5NDRs25OwW4LfffiORSMTJG+LLly8nGxsb1nX5ouJtdVW/TU/0li3KvXv3Jjc3NyouLlaVH7Xk7NmzJBQKafv27ZzoZ2VlkZWVFU2ePJkT/SNHjhAAysjI4ERf1SxatIjs7e15qf3GwNy/f59MTU1p2rRpqvKjduTn55OTkxN99NFHnHRUrNgQ16BBA842e1U0xTh8+DAn+qqmdevWNH78eF5qv7VrzI4dO4hhGNq5c6cq/KgV5eXl1L9/f7K2tubk07m8vJwmTJhAenp6FBsby7r+89jb29OyZcs4raEKHj9+TCKRiMLCwnipX61GfjNnziSpVEpHjx7l2o9aMWXKFNLR0aFTp0698ecyMjIoKyurRtolJSU0YsQIkkqltH///vexWS169epFgwcP5rwO1/z5558kFospNzeXl/rVCkx5eTkNHz6cDA0N6dixY1x74h2lUkmBgYEkFApp7969r3z//v37tG3bNpowYQI5OjoSgBqdanbjxg1q2bIlGRkZqew0tIULF5Kzs7NKanGJv78/de3albf61e6trFAoaMiQISSVSmnHjh1ceuIVuVxOw4YNI4lEUjnJv3nzJv366680atQosre3JwAkEAheODemOh0Xnzx5QgsWLCCpVEpeXl5069Ytri+nkj179pBAIKC8vDyV1WSbkpISMjIyYrXpYU2pUff+8vJymjVrFjEMQ3PnzlX5YUFcc/fuXWrTpg0ZGBjQzJkzacSIEWRtbU0ASCgUkkgkeu1hSm+6Rfj3339p7ty5ZGJiQiYmJhQUFKTyBh4pKSkEgGJiYlRal03Cw8MJAN25c4c3D+90AtnmzZtJX1+fPvjgA5U21OOK8vJymjRpEonFYhIIBASARCIRCYXCap08JpFIXlhBKykpoWPHjtGXX35JXl5eJBAIyM7Ojr799lt68uQJL9eoVCrJ1NSU1q1bx0t9Npg8eTK1bNmSVw/vfGTf9evXqUWLFqSrq0vffPONyt/pYYuUlBTq1asXASBvb28yMzMjhmGIYZhqhQUAmZub0/Tp06lXr14vHPHn7OxMU6dOpYMHD6p8RKmKTp060bhx4/i28U4olUqyt7enJUuW8Orjvc64VCgU9MMPP5CBgQE1adKEtm3bpjEvbGZlZdHcuXNJV1eXXF1dK5uNl5SUUEhICDk6OhLDMNUaZWxsbKht27Y0cuRI+vrrr2nbtm107949fi+wCj7//PO39nxTV+Li4ggAXblyhVcfrBw7/uDBAwoICCCRSERNmzalrVu3qu3bAffv36fZs2eTgYEBWVpaUlBQUJVzsfLyctq/f3/lcXuvm78wDEMDBw7k4UpqTkhICEmlUo2ce86fP58aNGjAtw12AlPBrVu3aPTo0SSRSMjMzIxmzpzJ+Xkd1UGhUNCBAweod+/eJBQKSUdHh77++msqLCys1n8fHR1N3bt3J4ZhSCwWvzJ/mT59OsdXwA5Xr15Vi0/pd8HV1ZVmzpzJtw12A1NBRkYGLV26lBo1akQAqFmzZrRgwQI6f/68ym7Z8vLyaN++fRQQEFA5L+nSpQsFBwdTs2bNqEmTJjVuLH7hwgUaOHAgCQSCyuBIJBJaunQpR1fBLqWlpaSjo0O//fYb31ZqxO3btwkAZ2f01AROAlNBeXk5nTp1imbOnEkNGjQgAGRsbEw9e/akZcuWUUREBKWlpb13ndLSUrp+/TqFhYXRrFmzyNvbm0QiEQkEAmrbti2tXLnyhaXIzMxM8vT0pPr161NycnKN6926datyVQ2ARv0BtmrVSi0+qWvCihUryMzMTC0WThgi1W32TkxMxMmTJ3Hq1CnExMRUdro0MzODs7MzrK2t4eDgAEtLSxgbG0MqlUJPTw9SqRT5+fkoKytDfn4+8vLy8ODBA2RmZuL+/fuV+/5FIhFcXFzQsWNHdOjQAR06dICVlVWVXp48eYKPP/4Yd+7cQWRk5Dvt08/MzMSaNWvQs2dPtG3b9r1+N6piwoQJuHXrFk6cOMG3lWrzwQcfwMXFBVu3buXbClQamJfJyclBQkICrl27htu3byMjIwNpaWnIzMxEXl4e5HI5CgsLoVAoYGBgALFYDENDQxgZGcHOzg7W1tawt7dHs2bN4ObmBldX1xrtwCssLESfPn1w+fJlHD58GN7e3hxerXqwfv16zJ8/H0+ePFHrDqMVpKSkhXsIHwAAFyFJREFUoEmTJjh8+LDq9+9XBb8DHP8UFhbShx9+SCYmJnTmzBm+7XDO6dOnCQClpKTwbaVafP/992RhYaEWt2NEr9nTX5fQ09PDgQMH0KlTJ3Tr1g1RUVF8W+KUFi1aQCAQaMyW5dDQUAwaNEjlR5u8jjofGODZMRO7du1Cv3790KdPH0RERPBtiTP09fXh5OSkEYG5ceMGrl69isGDB/NtpRJtYP5DJBLht99+w+DBg9GnTx/89ddffFviDE05N2bHjh2wsbFRae/kt6ENzHMIhUJs3rwZkyZNgr+/P7Zt28a3JU7QlC4yu3btwpAhQyAUCvm2Uol63BiqEQzDYM2aNRCLxRgzZgxKS0sxduxYvm2xiqenZ+Vq5OuW3fkmPj4eSUlJarGU/DzawFQBwzBYuXIlLC0tMX78eOTn52PGjBl822INmUwGALhy5Yp6LNVWQWhoKBo0aAAfHx++rbyANjBvYO7cuQCAmTNnIj8/H1999RXPjtjB0tIStra2uHz5sloGhogQFhaGYcOGqd2zIm1g3sLcuXNhZGSEzz77DAUFBfi///s/vi2xgjrPY06fPo27d+/C39+fbyuvoA1MNZgyZQpEIhEmT54MpVKJH374gW9L742npyf27NnDt40qCQkJgbu7Ozw9Pfm28graVbJqMmHCBGzfvh1BQUGYMmUKlEol35beC5lMhuTkZBQUFPBt5QWKi4uxe/dujBkzhm8rVaIdYWpARaPwQYMGoaCgAFu3blWbJ9A1xdPTE0qlEgkJCbwcMf869u7di4KCAgwbNoxvK1WiHWFqSO/evbF3717s2bMHI0aMQGlpKd+W3glHR0cYGxur3TwmJCQEH3/8sUqP4asJ2sC8Ax9//DHCw8Nx6NAh9O/fHyUlJXxbqjEMw6BFixZq9cQ/LS0NUVFRCAgI4NvKa9EG5h3p2LEjoqKicObMGfTr16/yuHZNQt1WyrZt2wZjY2P06tWLbyuvRRuY98Db2xuRkZG4cOECunfvjvz8fL4t1QhPT08kJCSozW3l77//jqFDh6r8VLGaoA3Me9KyZUucOnUKt2/fRufOnZGbm8u3pWojk8kgl8tx8+ZNvq0gLi4OSUlJan07BmgDwwouLi44duwYMjIy0LVrVzx69IhvS9XC1dWV1yPmnyckJASurq5qv+tVGxiWaNq0KWJiYpCXl4eOHTtW9itQZ8RiMVxdXXmf+BcXF2Pnzp1qP7oA2sCwSoMGDRAdHQ2BQIB27drhzp07fFt6K56enryPMKGhoSgsLMTo0aN59VEdtIFhGRsbGxw7dgyGhobo1KkTbt++zbelN1KxUkb89ULBL7/8gk8++QSWlpa8eagu2sBwgKWlJU6cOAEbGxu0b98eiYmJfFt6LZ6ennjy5Anu3bvHS/2EhAScPXsWkyZN4qV+TdEGhiNMTU0RERGBxo0bo0uXLrhy5QrflqrE09MTAoGAt3nML7/8gsaNG8PPz4+X+jVFGxgOMTY2xpEjR9CiRQt06tQJsbGxfFt6BQMDAzRu3JiXeUxxcTG2b9+OSZMmqd2+l9ehDQzHVLRx6tixI7p164Zjx47xbekVZDIZLyPMzp07UVhYqBGrYxVoA6MCpFIpwsLC0L17d/Tu3RtHjhzh29IL8LVS9ssvv6Bfv34aMdmvQBsYFSGRSLBz504MGjQIvXv3xt9//823pUpkMhkePHiA7OxsldW8evUqYmNjNWayX4E2MCpEKBRi69atmDhxIvz9/bFr1y6+LQF49noPAJXelm3cuBHOzs7o1KmTymqygWbuftJgGIbBTz/9BLFYjKFDh6KgoID33YWWlpawtrbG5cuX0bVrV87rPXnyBNu2bcN3332nMZP9CrSB4QGGYbBq1SoYGRlh3LhxKCgowLRp03j1pMpX/St6jWnCk/2X0QaGRxYvXgxdXV3MmDEDpaWlmDVrFm9eZDIZ9u7dy3kdIsLGjRsREBAAY2NjzuuxDs+nB2ghonXr1hHDMDR37lzePISFhZFQKKz2uZ/vysGDBwkAJSQkcFqHK7QjjBowdepUiMViTJkyBQB46X0mk8lQXl6OhIQEtGjRAgkJCbh06RIuX76MBQsWwM7OjpU6a9euRbdu3eDu7s6KnsrhO7Fa/sf27dtJJBLRp59+SkqlUiU1c3NzKSoqilasWEHNmzenRo0akVAorDxSXSAQvNMR8pGRkRQVFfXC15KTk0kgEND+/fvZsq9ytIFRM8LCwkgsFtOECROovLycszo//PAD2dnZVR6fLhaLSSQSvXCkOgCys7N7J/158+YRAPLw8KAdO3ZQaWkpTZs2jRo0aKCyk7S5QBsYNeSff/4hHR0dGjp0KGdH1V29epUEAsErAXn5X9euXd9Jf8yYMSQQCEggEBDDMGRnZ0fGxsb0/fffs3wlqkX74FIN6dGjB8LDw3HgwAH0798fcrn8/9s796Coyv+Pv8/eZQFhl7ioeIEBuaxojEkaaFgzlpqGeSlRMUWSUEsxy1tmY94zU8QxzMbxkhjjRDgqqWizOKIJZoCKmoiC7MLuqlzWYJf9/P7wx85XYRXWvdp5zeyM+Bzez5ud8z6X55zn81i8j379+mH27Nng8/kmtxEIBAgLCzNLv7KyEgaDAQaDAUSEqqoqNDQ0YNWqVfjkk0+cYkZqu9g7sSymkcvl5O7uTm+//TZptdp2t8nLyzP7fkej0VDXrl1Nnl34fD6lpaWZpR0WFmZSl8fjEZ/Pp8TERCorKzNL316wgXFwLly4QFKplIYNG0Z1dXWPteXk5BCfz6dffvnFbP0tW7Y89dLs999/N0vXy8vrmZd7XC6XcnJyzPZuD9jAOAGlpaXk5+dHr732Gt2/f5+IHo1C8fl8YhiGgoODzR4g0Ov1FBISYhwZe/JTUVHRac2WlhaTeq0fDodDP//8s1me7QkbGCfh6tWr1KNHD4qMjKQjR45Qly5djGeG5935Tp482e5OLRAIzAqiQqF4algYhqGdO3ea7deesIFxIm7cuEF+fn4kFAofO4JzOBzq06fPcw3Xjh49mvh8/mM7dkhIiFlaly5dempYtm/fbrZPe8OOkjkRWq0WjY2N0Ov1aGlpMf6/wWBARUUFDhw4YLb2999//9jPHA7H7BEyhUJhsm39+vWYPXu2WbqOABsYJ+H69euIjY2FVqt9LCytEBGWLl0KvV5vln5AQAAWLFhgXO+Gz+cjNDTULC2FQgEO5/Fdi2EYrF69GgsXLjRL01FgA+ME3Lx5E9HR0Xjw4IHJQBAR7ty5g3379pndz7Jly+Dp6QmGYaDT6RAcHGyWjkKheGyhKQ6Hg+XLl2Px4sVme3MU2MA4ARs2bEBtbe0zJ1sREb788kuzq/G7urpi/fr1ICIYDAYEBQWZpaNUKo3/5nA4mDNnDlauXGmWlqPBENmx5CFLhykuLsbWrVuxe/duEJHJUHA4HPzwww+YOXOmWf0YDAbjMhhHjhwBn89HU1MTtFoteDwe3NzcwOVy4eHhAR8fH/j4+IDL5T6mMWXKFOzfvx8MwyApKQnp6elON7PSFGxgnAylUont27dj06ZNePjwYZtLNIZh4Ofnh/LycggEApM6RITLly+jqKgIJSUlKCkpQVlZGaqqqjq1ohqXy4WPjw8CAgIgk8kgk8mQkZGBS5cuISEhAT/99NMLExaADYzTUl9fj127dmHdunVQKBRgGMa4sjOHw0F6enqbiiwVFRXIyclBXl4e5HI5VCoVhEIhQkNDER4ejtDQUPj7+8PPzw9yuRzJyckQiUQQCoVwcXGBTqdDQ0MDDAYDNBoNlEol7t69i7t376KsrAyXL19GSUkJNBoNOBwOhgwZgtjYWIwcORJRUVEvRHDYwDg5Op0OBw4cwNq1a3H58mXw+XzodDr4+vri1q1bUKlU2L17Nw4dOoTCwkJ07doVw4YNw+uvv46hQ4eif//+Fl8J+v3338eIESNw5swZnDp1Cjdv3kT37t3x7rvvIj4+3qFWbe409nj4w2J5DAYD5ebmUmxsrPEhYUREBPF4PPLy8qKkpCQ6evQoNTU1Wd1Lc3PzYz///ffftHLlSoqIiCAA1L9/f0pPT6f6+nqre7E0bGBeMI4fP07h4eHGV1vS0tJMvulsDy5cuEBJSUkkFotJKpXSihUrjO/HOQPsJdkLwrlz5zBnzhwUFhZi7NixWLFiBSQSCYgIvXr1sre9NqhUKmzatAlpaWkQCoVYtWoVZs2a1eaB5/9y//59KJVKqFQqqNVq4zwhLpcLLy8vSKVSeHt746WXXrKecTsHluU5uXfvHn300UfE4XAoNjaWLl68aG9LnUKlUlFqairx+XwaNGgQFRYWUnNzMxUUFNDmzZtp2rRpFBUVRRKJ5JnTBVo/EomEYmJiKCUlhbKyskitVlvML3uGcWLOnDmDyZMno7m5GRs3bkR8fLy9LZlNSUkJPv74YxQUFMDT0xM1NTWQSqUYOHAgQkJCEBwcjICAAPj5+UEqlUIqlaJLly4AHg18qNVqqNVq1NTU4MqVKyguLkZhYSGKiopARIiJicGMGTPw3nvvQSwWm2/UYtFjsSlr1qwhHo9Ho0ePptraWnvbsQgGg4HWrVtHPB6PYmJiSKPRPLemRqOhrKwsGjduHAkEAvLw8KCvv/66zWS8jsIGxsnQ6/WUlJREXC6XvvvuO5uVY7IlBQUF1KNHD5LJZHTnzh2L6dbW1tLKlSupa9eu5OXlRXv37u20BhsYJ0Kn01FcXBy5uLhQdna2ve1Yldu3b1N4eDj5+/vTjRs3LKqt0Who7ty5xDAMjR8/vlOjdGxgnASDwUAJCQkkFospPz/f3nZsgkajoYEDB1JgYCApFAqL6584cYK6detGAwYMoOrq6g79DhsYJ2Hp0qUkEAjo2LFj9rZiU2pqaig4OJgiIyPNqsD5LMrLyyk4OJiCgoI6dC/IBsYJOHHiBHE4HMrIyLC3Fbvwzz//kIeHB6WkpFhFX6lUUu/evSk2NvaZhRPZwDg4Go2GunXrRhMnTrS3FbuSmZlJDMPQ4cOHraL/119/kVgspuXLlz91OzYwDk5qaip5e3vTvXv3bNKfWCxut3CFh4cHRUREUHJyMl24cMEmXp7kgw8+oKCgoDbvqlmKTZs2kVAopOvXr5vchg2MA3Pz5k0SCoW0bds2m/Z78eJFAkBjx44lokdD2QqFgn799Vfjy53Tp0+3+loyT3Lr1i0SiUS0detWq+g3NzdTSEgIxcfHm9yGDYwDM3/+fOrTp4/VjqimeDIwT7Jo0SICQGPGjLH5c6B58+ZRnz59rLaywa5du0ggEJgcAGDn9DsoOp0Oe/fuxYwZM55aMNwerF27FlFRUfjtt9+eq7STOSQnJ6O8vBynT5+2iv7EiRMhEomwf//+dtvZwDgoJ0+ehEqlQkJCgr2ttIFhGMyZMwcAkJ6ebtO+Q0JCEBUVZXKHfl7EYjFGjhyJ3NzcdtvZwDgocrkcffv2hb+/v72ttEt0dDQAoKCgwOwqNeby5ptvIj8/32r6r776Ks6dOwdq571kNjAOSkFBgUNP5fX19QUA6PV6qFQqm/Y9ZMgQXLt2DWq12ir6r7zyCtRqNW7fvt2mjQ2Mg3Lr1i307dvX3jZM0t7R11YEBweDiNrdoS1Bt27dAAA1NTVt2tjAOChqtRpSqdTeNkxSXV0N4FFJWS8vL5v23fq9WOvMJpFIAAAajaZNGxsYB0Wr1RonSDkirfcQgwcPtvkoXusEsMbGRqvou7i4mNRnA+OgeHp64t69e/a20S4GgwHbtm0DAKSkpNi8/9Yjf+uZwNI0NDQAeFQ690nYwDgoXl5eqK2ttbeNdlm8eDHOnz+PuLg4TJgwweb9t34v1roUbB1M8PT0bNNm2QpuLBYjPDwcFy9etLcNAI/OKCqVCmfPnsWWLVuQl5eHGTNmIC0tzS7VLIuKiiAUChEYGGgV/WvXrgFAu8XY2cA4KEOGDME333wDIrLpTunq6mq8ds/OzgbDMGAYBu7u7ujZsyeio6OxYcMGREZG2szTk5w9exYDBw6EUCi0in5RURH8/f3h4eHRpo0NjIPyxhtvYP78+Thz5ozxIaEtaL1+d1T0ej1ycnKQmJhotT6OHz+O4cOHt9vG3sM4KP369cPLL7+MXbt22duKQ3H06FFUV1dj2rRpVtGvrKxEfn4+3nnnnXbb2cA4MImJicjMzMTdu3ftbcVh2Lx5M4YPH261+5cdO3ZAIpGYDAz7er8D8/DhQ+rVqxclJiba24pDcOTIEQJAcrncKvpKpZLc3Nxo9erVJrdhA+Pg7Nmzh7hcLp07d87eVuyKVqulsLAwk3N0LMGkSZPI39//qRPj2MA4OAaDgUaNGkWBgYH04MEDe9uxG8nJyeTh4UHl5eVW0c/IyCCGYSg3N/ep27GBcQKqq6vJ29ubJkyYYLWZho7Mvn37iGEYOnjwoFX0Dx8+THw+n5YtW/bMbdnAOAmnTp0ioVBIc+fOtbcVm5Kbm0sCgYAWLlz41O20Wq1ZFTL37t1LAoGAZs6c2aHp1mxgnIisrCzicrm0aNGiF7Km8pMcP36cXF1daerUqW3+3rq6Ojp27BgtWbKEoqKiiM/nU1JSUoe1GxsbKSUlhQBQampqh79PNjBOxp49e4jP59PUqVNtXhzDlrQe+SdPnkzNzc2kVqspOzubFixYQAMGDCAul0sASCQSEcMwxOVyacWKFc/UbWlpoYMHD1KvXr3Iw8ODMjMzO+WLDYwTkpubS25ubhQdHU0VFRX2tmNRmpub6bPPPiOGYSguLo4+//xzioiIIIZhjMsQop1FlHg8Hu3YscOkbn19PWVkZJBMJiMOh0NTpkzpcD3l/4UNjJNSXFxMYWFhJJFIKCsry952LEJmZiZ5e3sbw8EwjMmAtPd5ckWD0tJS2rx5M40aNYrEYjGJRCKaOnUqlZSUmO2RDYwT09jYSLNmzTLWCLPWkKu1efjwIX311VckEomod+/eFBYWZjxrdDQs+P/igpMmTaJBgwaRVCo1Lt83fvx42rFjB6lUquf2ygbmBSAvL49CQ0PJxcWFFi9e7DQrkun1etq9ezcFBgaSm5sbbdy40XhfJpfL6a233iKGYYjP53coMOHh4RQXF0epqamUlpZG58+fJ71eb1HPbGBeEJqbm+nbb78lb29vcnV1pS+++MKiq3dZEq1WSz/++CMFBQURj8ejDz/8kCorK9vd9tKlSxQfH09cLvepwWEY5pmV9y0BG5gXjIaGBtqwYQP5+voSl8ulMWPG0OHDhx1iRK24uJg+/fRT8vT0JIFAQNOnT+/ws5Py8nKaN28eCYXCdoMjkUis7P4RbGBeUJqamigzM5NiY2OJYRiSSCSUkJBA2dnZVF9fbxMPer2e/vzzT1qyZAmFhIQQAAoICKA1a9aYvaJYTU0NLV++nNzd3Y1DywAoLCzMwu7bh112/D9AeXk5Dh06hEOHDqGgoAAcDgeRkZGIiYlBVFQUZDIZgoKCwOM933zCqqoqlJaWorCwEPn5+cjPz0ddXR169+6NcePGYdy4cRg8eDA4nOefVdLQ0ICdO3di3bp1UCgUGDFiBI4dO/bcus+CDcx/DKVSiT/++ANyuRynT5/GlStX0NLSAoFAgODgYPTs2RO+vr7o0aMH3N3d4ebmBh6PBzc3NzQ1NUGr1aKpqQkPHjyAUqlEZWUlFAoFysrKjFVuunfvjujoaAwdOhRDhw6FTCaz2t+j0+mwf/9+KJVKLFq0yGr9tMIG5j/Ov//+iytXrqC0tBRXr141BqCqqgp1dXWor6+HTqdDQ0MDBAIBxGIxRCIR3Nzc4OPjg+7du8PX1xdBQUEIDw+HTCZz6AKEzwsbGBaWTsBOUWZh6QRsYFhYOgEbGBaWTsAD8Iu9TbCwOAv/Byba+ZClEOqsAAAAAElFTkSuQmCC" alt="Markov model for comparison of HIV therapy.
           A: 200 &lt; cd4 &lt; 500, B: cd4 &lt; 200, C: AIDS, D: Death." width="204" />
<p class="caption">
Markov model for comparison of HIV therapy. A: 200 &lt; cd4 &lt; 500, B:
cd4 &lt; 200, C: AIDS, D: Death.
</p>
</div>
</div>
<div id="per-cycle-transition-probabilities" class="section level2">
<h2>Per-cycle transition probabilities</h2>
<p>The per-cycle transition probabilities are the cells of the Markov
transition matrix. For the monotherapy model, the transition matrix is
shown below. This is consistent with the Table 1 of Chancellor <em>et
al</em><span class="citation"><sup>2</sup></span>.</p>
<table style="width:65%;">
<colgroup>
<col width="12%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">A</th>
<th align="center">B</th>
<th align="center">C</th>
<th align="center">D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="center">0.7215</td>
<td align="center">0.2018</td>
<td align="center">0.0669</td>
<td align="center">0.009804</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="center">0</td>
<td align="center">0.5811</td>
<td align="center">0.407</td>
<td align="center">0.01192</td>
</tr>
<tr class="odd">
<td align="left">C</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0.7501</td>
<td align="center">0.2499</td>
</tr>
<tr class="even">
<td align="left">D</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="running-the-model" class="section level1">
<h1>Running the model</h1>
<p>Model function <code>cycle</code> applies one cycle of a Markov model
to a defined starting population in each state. It returns a table with
one row per state, and each row containing several columns, including
the population at the end of the state and the cost of occupancy of
states, normalized by the number of patients in the cohort, with
discounting applied.</p>
<p>Multiple cycles are run by feeding the state populations at the end
of one cycle into the next. Function <code>cycles</code> does this and
returns a data frame with one row per cycle, and each row containing the
state populations and the aggregated cost of occupancy for all states,
with discounting applied. This is done below for the first 20 cycles of
the model for monotherapy, with discount. For convenience, and future
use with probabilistic sensitivity analysis, a function,
<code>run_mono</code> is used to wrap up the steps needed to run 20
cycles of the model for monotherapy. The arguments to the function are
the transition probability matrix, the occupancy costs for states A, B,
and C, and logical variables which determine whether to apply half-cycle
correction to the state populations, costs and QALYs returned in the
Markov trace.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function to run model for 20 years of monotherapy</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>run_mono <span class="ot">&lt;-</span> <span class="cf">function</span>(Ptm, cAm, cBm, cCm, <span class="at">hcc =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create starting populations</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> 1000L</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  populations <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">A =</span> N, <span class="at">B =</span> 0L, <span class="at">C =</span> 0L, <span class="at">D =</span> 0L)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  m<span class="sc">$</span><span class="fu">reset</span>(populations)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set costs</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  sA<span class="sc">$</span><span class="fu">set_cost</span>(cAm)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  sB<span class="sc">$</span><span class="fu">set_cost</span>(cBm)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  sC<span class="sc">$</span><span class="fu">set_cost</span>(cCm)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set transition probabilities</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  m<span class="sc">$</span><span class="fu">set_probabilities</span>(Ptm)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run 20 cycles</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  tr <span class="ot">&lt;-</span> m<span class="sc">$</span><span class="fu">cycles</span>(</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncycles =</span> 20L, <span class="at">hcc.pop =</span> hcc, <span class="at">hcc.cost =</span> <span class="cn">FALSE</span>, <span class="at">hcc.QALY =</span> hcc</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tr)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<blockquote>
<p>Coding note: In function <code>run_mono</code>, the occupancy costs
for states A, B and C are set via calls to function
<code>set_cost()</code> which is associated with a
<code>MarkovState</code> object. Although these are set <em>after</em>
the state objects <code>sA</code>, <code>sB</code> and <code>sC</code>
have been added to model <code>m</code>, the updated costs are used when
the model is cycled. This is because Rs R6 objects, such as Markov
states and transitions, are passed by reference. That is, if an R6
object such as a <code>MarkovState</code> changes, any other object that
refers to it, such as a <code>SemiMarkovModel</code> will see the
changes. This behaviour is different from regular R variable types, such
as numeric variables, which are passed by value; that is, a copy of them
is created within the function to which they are passed, and any change
to the original would not apply to the copy.</p>
</blockquote>
<p>The model is run by calling the new function, with appropriate
arguments. The cumulative cost and life years are calculated by summing
the appropriate columns from the Markov trace, as follows:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>MT.mono <span class="ot">&lt;-</span> <span class="fu">run_mono</span>(Ptm, cAm, cBm, cCm)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>el.mono <span class="ot">&lt;-</span> <span class="fu">sum</span>(MT.mono<span class="sc">$</span>QALY)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>cost.mono <span class="ot">&lt;-</span> <span class="fu">sum</span>(MT.mono<span class="sc">$</span>Cost)</span></code></pre></div>
<p>The populations and discounted costs are consistent with Briggs
<em>et al</em>, Table 2.3<span class="citation"><sup>1</sup></span>, and
the QALY column is consistent with Table 2.4 (without half cycle
correction). No discount was applied to the utilities.</p>
<table style="width:67%;">
<colgroup>
<col width="11%" />
<col width="9%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="9%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">Years</th>
<th align="right">A</th>
<th align="right">B</th>
<th align="right">C</th>
<th align="right">D</th>
<th align="right">Cost</th>
<th align="right">QALY</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">1000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">721</td>
<td align="right">202</td>
<td align="right">67</td>
<td align="right">10</td>
<td align="right">5153</td>
<td align="right">0.99</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">520</td>
<td align="right">263</td>
<td align="right">181</td>
<td align="right">36</td>
<td align="right">5393</td>
<td align="right">0.964</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">376</td>
<td align="right">258</td>
<td align="right">277</td>
<td align="right">89</td>
<td align="right">5368</td>
<td align="right">0.911</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">271</td>
<td align="right">226</td>
<td align="right">338</td>
<td align="right">165</td>
<td align="right">5055</td>
<td align="right">0.835</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">195</td>
<td align="right">186</td>
<td align="right">364</td>
<td align="right">255</td>
<td align="right">4541</td>
<td align="right">0.745</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">141</td>
<td align="right">147</td>
<td align="right">361</td>
<td align="right">350</td>
<td align="right">3929</td>
<td align="right">0.65</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">102</td>
<td align="right">114</td>
<td align="right">341</td>
<td align="right">444</td>
<td align="right">3301</td>
<td align="right">0.556</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">73</td>
<td align="right">87</td>
<td align="right">309</td>
<td align="right">531</td>
<td align="right">2708</td>
<td align="right">0.469</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">53</td>
<td align="right">65</td>
<td align="right">272</td>
<td align="right">610</td>
<td align="right">2179</td>
<td align="right">0.39</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">38</td>
<td align="right">49</td>
<td align="right">234</td>
<td align="right">679</td>
<td align="right">1727</td>
<td align="right">0.321</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="right">28</td>
<td align="right">36</td>
<td align="right">198</td>
<td align="right">739</td>
<td align="right">1350</td>
<td align="right">0.261</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">20</td>
<td align="right">26</td>
<td align="right">165</td>
<td align="right">789</td>
<td align="right">1045</td>
<td align="right">0.211</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">14</td>
<td align="right">19</td>
<td align="right">136</td>
<td align="right">830</td>
<td align="right">801</td>
<td align="right">0.17</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">10</td>
<td align="right">14</td>
<td align="right">111</td>
<td align="right">865</td>
<td align="right">609</td>
<td align="right">0.135</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">7</td>
<td align="right">10</td>
<td align="right">90</td>
<td align="right">893</td>
<td align="right">460</td>
<td align="right">0.107</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">5</td>
<td align="right">8</td>
<td align="right">72</td>
<td align="right">915</td>
<td align="right">346</td>
<td align="right">0.085</td>
</tr>
<tr class="even">
<td align="right">17</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">57</td>
<td align="right">933</td>
<td align="right">258</td>
<td align="right">0.067</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">45</td>
<td align="right">948</td>
<td align="right">192</td>
<td align="right">0.052</td>
</tr>
<tr class="even">
<td align="right">19</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">36</td>
<td align="right">959</td>
<td align="right">142</td>
<td align="right">0.041</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">28</td>
<td align="right">968</td>
<td align="right">105</td>
<td align="right">0.032</td>
</tr>
</tbody>
</table>
</div>
<div id="model-results" class="section level1">
<h1>Model results</h1>
<div id="monotherapy" class="section level2">
<h2>Monotherapy</h2>
<p>The estimated life years is approximated by summing the proportions
of patients left alive at each cycle (Briggs <em>et al</em><span class="citation"><sup>1</sup></span>, Exercise 2.5). This is an
approximation because it ignores the population who remain alive after
21 years, and assumes all deaths occurred at the start of each cycle.
For monotherapy the expected life gained is 7.991 years at a cost of
44,663 GBP.</p>
</div>
<div id="combination-therapy" class="section level2">
<h2>Combination therapy</h2>
<p>For combination therapy, a similar model was created, with adjusted
costs and transition rates. Following Briggs <em>et al</em><span class="citation"><sup>1</sup></span> the treatment effect was applied to
the probabilities, and these were used as inputs to the model. More
usually, treatment effects are applied to rates, rather than
probabilities.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># annual probabilities modified by treatment effect</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>pAB <span class="ot">&lt;-</span> RR <span class="sc">*</span> nAB <span class="sc">/</span> nA</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>pAC <span class="ot">&lt;-</span> RR <span class="sc">*</span> nAC <span class="sc">/</span> nC</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>pAD <span class="ot">&lt;-</span> RR <span class="sc">*</span> nAD <span class="sc">/</span> nA</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>pBC <span class="ot">&lt;-</span> RR <span class="sc">*</span> nBC <span class="sc">/</span> nB</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>pBD <span class="ot">&lt;-</span> RR <span class="sc">*</span> nBD <span class="sc">/</span> nB</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>pCD <span class="ot">&lt;-</span> RR <span class="sc">*</span> nCD <span class="sc">/</span> nC</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># annual transition probability matrix</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>Ptc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fl">1.0</span> <span class="sc">-</span> pAB <span class="sc">-</span> pAC <span class="sc">-</span> pAD,               pAB,         pAC, pAD,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0</span>, (<span class="fl">1.0</span> <span class="sc">-</span> pBC <span class="sc">-</span> pBD),         pBC, pBD,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0</span>,               <span class="fl">0.0</span>, (<span class="fl">1.0</span> <span class="sc">-</span> pCD), pCD,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0</span>,               <span class="fl">0.0</span>,         <span class="fl">0.0</span>, <span class="fl">1.0</span>),</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> 4L, <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">dimnames =</span> <span class="fu">list</span>(</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">source =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>), <span class="at">target =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The resulting per-cycle transition matrix for the combination therapy
is as follows:</p>
<table style="width:67%;">
<colgroup>
<col width="12%" />
<col width="12%" />
<col width="12%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">A</th>
<th align="center">B</th>
<th align="center">C</th>
<th align="center">D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="center">0.8585</td>
<td align="center">0.1027</td>
<td align="center">0.03376</td>
<td align="center">0.00499</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="center">0</td>
<td align="center">0.7868</td>
<td align="center">0.2072</td>
<td align="center">0.006069</td>
</tr>
<tr class="odd">
<td align="left">C</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0.8728</td>
<td align="center">0.1272</td>
</tr>
<tr class="even">
<td align="left">D</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<p>In this model, lamivudine is given for the first 2 years, with the
treatment effect assumed to persist for the same period. The state
populations and cycle numbers are retained by the model between calls to
<code>cycle</code> or <code>cycles</code> and can be retrieved by
calling <code>get_populations</code>. In this example, the combination
therapy model is run for 2 cycles, then the population is used to
continue with the monotherapy model for the remaining 18 years. The
<code>reset</code> function is used to set the cycle number and elapsed
time of the new run of the mono model. As before, function
<code>run_comb</code> is created to wrap up these steps, so they can be
used repeatedly for different values of the model variables.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function to run model for 2 years of combination therapy and 18 of monotherapy</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>run_comb <span class="ot">&lt;-</span> <span class="cf">function</span>(Ptm, cAm, cBm, cCm, Ptc, cAc, cBc, cCc, <span class="at">hcc =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set populations</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> 1000L</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  populations <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">A =</span> N, <span class="at">B =</span> 0L, <span class="at">C =</span> 0L, <span class="at">D =</span> 0L)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  m<span class="sc">$</span><span class="fu">reset</span>(populations)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set the transition probabilities accounting for treatment effect</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  m<span class="sc">$</span><span class="fu">set_probabilities</span>(Ptc)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set the costs including those for the additional drug</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  sA<span class="sc">$</span><span class="fu">set_cost</span>(cAc)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  sB<span class="sc">$</span><span class="fu">set_cost</span>(cBc)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  sC<span class="sc">$</span><span class="fu">set_cost</span>(cCc)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run first 2 yearly cycles with additional drug costs and tx effect</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  tr <span class="ot">&lt;-</span> m<span class="sc">$</span><span class="fu">cycles</span>(2L, <span class="at">hcc.pop =</span> hcc, <span class="at">hcc.cost =</span> <span class="cn">FALSE</span>, <span class="at">hcc.QALY =</span> hcc)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># save the state populations after 2 years</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  populations <span class="ot">&lt;-</span> m<span class="sc">$</span><span class="fu">get_populations</span>()</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># revert probabilities to those without treatment effect</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  m<span class="sc">$</span><span class="fu">set_probabilities</span>(Ptm)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># revert costs to those without the extra drug</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  sA<span class="sc">$</span><span class="fu">set_cost</span>(cAm)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  sB<span class="sc">$</span><span class="fu">set_cost</span>(cBm)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  sC<span class="sc">$</span><span class="fu">set_cost</span>(cCm)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># restart the model with populations from first 2 years with extra drug</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  m<span class="sc">$</span><span class="fu">reset</span>(</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    populations,</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">icycle =</span> 2L,</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">elapsed =</span> <span class="fu">as.difftime</span>(<span class="fl">365.25</span> <span class="sc">*</span> <span class="fl">2.0</span>, <span class="at">units =</span> <span class="st">&quot;days&quot;</span>)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run for next 18 years, combining the traces</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  tr <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    tr,</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>    m<span class="sc">$</span><span class="fu">cycles</span>(<span class="at">ncycles =</span> 18L, <span class="at">hcc.pop =</span> hcc, <span class="at">hcc.cost =</span> <span class="cn">FALSE</span>, <span class="at">hcc.QALY =</span> hcc)</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return the trace</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tr)</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The model is run by calling the new function, with appropriate
arguments, as follows. The incremental cost effectiveness ratio (ICER)
is also calculated, as the ratio of the incremental cost to the
incremental life years of the combination therapy compared with
monotherapy.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>MT.comb <span class="ot">&lt;-</span> <span class="fu">run_comb</span>(Ptm, cAm, cBm, cCm, Ptc, cAc, cBc, cCc)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>el.comb <span class="ot">&lt;-</span> <span class="fu">sum</span>(MT.comb<span class="sc">$</span>QALY)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>cost.comb <span class="ot">&lt;-</span> <span class="fu">sum</span>(MT.comb<span class="sc">$</span>Cost)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>icer <span class="ot">&lt;-</span> (cost.comb <span class="sc">-</span> cost.mono) <span class="sc">/</span> (el.comb <span class="sc">-</span> el.mono)</span></code></pre></div>
<p>The Markov trace for combination therapy is as follows:</p>
<table style="width:67%;">
<colgroup>
<col width="11%" />
<col width="9%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="9%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">Years</th>
<th align="right">A</th>
<th align="right">B</th>
<th align="right">C</th>
<th align="right">D</th>
<th align="right">Cost</th>
<th align="right">QALY</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">1000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">859</td>
<td align="right">103</td>
<td align="right">34</td>
<td align="right">5</td>
<td align="right">6912</td>
<td align="right">0.995</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">737</td>
<td align="right">169</td>
<td align="right">80</td>
<td align="right">14</td>
<td align="right">6736</td>
<td align="right">0.986</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">532</td>
<td align="right">247</td>
<td align="right">178</td>
<td align="right">43</td>
<td align="right">5039</td>
<td align="right">0.957</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">384</td>
<td align="right">251</td>
<td align="right">270</td>
<td align="right">96</td>
<td align="right">4998</td>
<td align="right">0.904</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">277</td>
<td align="right">223</td>
<td align="right">330</td>
<td align="right">170</td>
<td align="right">4713</td>
<td align="right">0.83</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">200</td>
<td align="right">186</td>
<td align="right">357</td>
<td align="right">258</td>
<td align="right">4245</td>
<td align="right">0.742</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">144</td>
<td align="right">148</td>
<td align="right">357</td>
<td align="right">351</td>
<td align="right">3684</td>
<td align="right">0.649</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">104</td>
<td align="right">115</td>
<td align="right">337</td>
<td align="right">443</td>
<td align="right">3102</td>
<td align="right">0.557</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">75</td>
<td align="right">88</td>
<td align="right">307</td>
<td align="right">530</td>
<td align="right">2551</td>
<td align="right">0.47</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">54</td>
<td align="right">66</td>
<td align="right">271</td>
<td align="right">609</td>
<td align="right">2057</td>
<td align="right">0.391</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="right">39</td>
<td align="right">49</td>
<td align="right">234</td>
<td align="right">678</td>
<td align="right">1633</td>
<td align="right">0.322</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">28</td>
<td align="right">37</td>
<td align="right">198</td>
<td align="right">737</td>
<td align="right">1279</td>
<td align="right">0.263</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">20</td>
<td align="right">27</td>
<td align="right">165</td>
<td align="right">787</td>
<td align="right">990</td>
<td align="right">0.213</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">15</td>
<td align="right">20</td>
<td align="right">136</td>
<td align="right">829</td>
<td align="right">760</td>
<td align="right">0.171</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">11</td>
<td align="right">14</td>
<td align="right">111</td>
<td align="right">864</td>
<td align="right">579</td>
<td align="right">0.136</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">8</td>
<td align="right">11</td>
<td align="right">90</td>
<td align="right">892</td>
<td align="right">437</td>
<td align="right">0.108</td>
</tr>
<tr class="even">
<td align="right">17</td>
<td align="right">6</td>
<td align="right">8</td>
<td align="right">72</td>
<td align="right">914</td>
<td align="right">329</td>
<td align="right">0.086</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="right">58</td>
<td align="right">933</td>
<td align="right">246</td>
<td align="right">0.067</td>
</tr>
<tr class="even">
<td align="right">19</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">46</td>
<td align="right">947</td>
<td align="right">183</td>
<td align="right">0.053</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">36</td>
<td align="right">959</td>
<td align="right">136</td>
<td align="right">0.041</td>
</tr>
</tbody>
</table>
</div>
<div id="comparison-of-treatments" class="section level2">
<h2>Comparison of treatments</h2>
<p>Over the 20 year time horizon, the expected life years gained for
monotherapy was 7.991 years at a total cost per patient of 44,663 GBP.
The expected life years gained with combination therapy for two years
was 8.94 at a total cost per patient of 50,607 GBP. The incremental
change in life years was 0.949 years at an incremental cost of 5,944
GBP, giving an ICER of 6,264 GBP/QALY. This is consistent with the
result obtained by Briggs <em>et al</em><span class="citation"><sup>1</sup></span> (6276 GBP/QALY), within rounding
error.</p>
</div>
<div id="results-with-half-cycle-correction" class="section level2">
<h2>Results with half-cycle correction</h2>
<p>With half-cycle correction applied to the state populations, the
model can be recalculated as follows.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>MT.mono.hcc <span class="ot">&lt;-</span> <span class="fu">run_mono</span>(Ptm, cAm, cBm, cCm, <span class="at">hcc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>el.mono.hcc <span class="ot">&lt;-</span> <span class="fu">sum</span>(MT.mono.hcc<span class="sc">$</span>QALY)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>cost.mono.hcc <span class="ot">&lt;-</span> <span class="fu">sum</span>(MT.mono.hcc<span class="sc">$</span>Cost)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>MT.comb.hcc <span class="ot">&lt;-</span> <span class="fu">run_comb</span>(Ptm, cAm, cBm, cCm, Ptc, cAc, cBc, cCc, <span class="at">hcc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>el.comb.hcc <span class="ot">&lt;-</span> <span class="fu">sum</span>(MT.comb.hcc<span class="sc">$</span>QALY)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>cost.comb.hcc <span class="ot">&lt;-</span> <span class="fu">sum</span>(MT.comb.hcc<span class="sc">$</span>Cost)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>icer.hcc <span class="ot">&lt;-</span> (cost.comb.hcc <span class="sc">-</span> cost.mono.hcc) <span class="sc">/</span> (el.comb.hcc <span class="sc">-</span> el.mono.hcc)</span></code></pre></div>
<p>Over the 20 year time horizon, the expected life years gained for
monotherapy was 8.475 years at a total cost per patient of 44,663 GBP.
The expected life years gained with combination therapy for two years
was 9.419 at a total cost per patient of 50,607 GBP. The incremental
change in life years was 0.944 years at an incremental cost of 5,944
GBP, giving an ICER of 6,295 GBP/QALY.</p>
</div>
</div>
<div id="probabilistic-sensitivity-analysis" class="section level1">
<h1>Probabilistic sensitivity analysis</h1>
<p>In their Exercise 4.7, Briggs <em>et al</em><span class="citation"><sup>1</sup></span> extended the original model to
account for uncertainty in the estimates of the values of the model
variables. In this section, the exercise is replicated in
<code>rdecision</code>, using the same assumptions.</p>
<div id="costs" class="section level2">
<h2>Costs</h2>
<p>Although it is possible to sample from uncertainty distributions
using the functions in R standard package <code>stats</code> (e.g.,
<code>rbeta</code>), <code>rdecision</code> introduces the notion of a
<code>ModVar</code>, which is an object that can represent a model
variable with an uncertainty distribution. Many of the class methods in
<code>redecision</code> will accept a <code>ModVar</code> as alternative
to a numerical value as an argument, and will automatically sample from
its uncertainty distribution.</p>
<p>The model costs are represented as <code>ModVar</code>s of various
types, as follows. The state occupancy costs for both models involve a
summation of other variables. Package <code>rdecision</code> introduces
a form of <code>ModVar</code> that is defined as a mathematical
expression (an <code>ExprModVar</code>) potentially involving
<code>ModVar</code>s. The uncertainty distribution of <code>cAm</code>,
for example, is complex, because it is a sum of two Gamma-distributed
variables and a scalar, but <code>rdecision</code> takes care of this
when <code>cAm</code> is sampled.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># direct medical and community costs (modelled as gamma distributions)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>dmca <span class="ot">&lt;-</span> GammaModVar<span class="sc">$</span><span class="fu">new</span>(<span class="st">&quot;dmca&quot;</span>, <span class="st">&quot;GBP&quot;</span>, <span class="at">shape =</span> <span class="fl">1.0</span>, <span class="at">scale =</span> <span class="fl">1701.0</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>dmcb <span class="ot">&lt;-</span> GammaModVar<span class="sc">$</span><span class="fu">new</span>(<span class="st">&quot;dmcb&quot;</span>, <span class="st">&quot;GBP&quot;</span>, <span class="at">shape =</span> <span class="fl">1.0</span>, <span class="at">scale =</span> <span class="fl">1774.0</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>dmcc <span class="ot">&lt;-</span> GammaModVar<span class="sc">$</span><span class="fu">new</span>(<span class="st">&quot;dmcc&quot;</span>, <span class="st">&quot;GBP&quot;</span>, <span class="at">shape =</span> <span class="fl">1.0</span>, <span class="at">scale =</span> <span class="fl">6948.0</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>ccca <span class="ot">&lt;-</span> GammaModVar<span class="sc">$</span><span class="fu">new</span>(<span class="st">&quot;ccca&quot;</span>, <span class="st">&quot;GBP&quot;</span>, <span class="at">shape =</span> <span class="fl">1.0</span>, <span class="at">scale =</span> <span class="fl">1055.0</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>cccb <span class="ot">&lt;-</span> GammaModVar<span class="sc">$</span><span class="fu">new</span>(<span class="st">&quot;cccb&quot;</span>, <span class="st">&quot;GBP&quot;</span>, <span class="at">shape =</span> <span class="fl">1.0</span>, <span class="at">scale =</span> <span class="fl">1278.0</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>cccc <span class="ot">&lt;-</span> GammaModVar<span class="sc">$</span><span class="fu">new</span>(<span class="st">&quot;cccc&quot;</span>, <span class="st">&quot;GBP&quot;</span>, <span class="at">shape =</span> <span class="fl">1.0</span>, <span class="at">scale =</span> <span class="fl">2059.0</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># occupancy costs with monotherapy</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>cAm <span class="ot">&lt;-</span> ExprModVar<span class="sc">$</span><span class="fu">new</span>(<span class="st">&quot;cA&quot;</span>, <span class="st">&quot;GBP&quot;</span>, rlang<span class="sc">::</span><span class="fu">quo</span>(dmca <span class="sc">+</span> ccca <span class="sc">+</span> cAZT))</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>cBm <span class="ot">&lt;-</span> ExprModVar<span class="sc">$</span><span class="fu">new</span>(<span class="st">&quot;cB&quot;</span>, <span class="st">&quot;GBP&quot;</span>, rlang<span class="sc">::</span><span class="fu">quo</span>(dmcb <span class="sc">+</span> cccb <span class="sc">+</span> cAZT))</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>cCm <span class="ot">&lt;-</span> ExprModVar<span class="sc">$</span><span class="fu">new</span>(<span class="st">&quot;cC&quot;</span>, <span class="st">&quot;GBP&quot;</span>, rlang<span class="sc">::</span><span class="fu">quo</span>(dmcc <span class="sc">+</span> cccc <span class="sc">+</span> cAZT))</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co"># occupancy costs with combination therapy</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>cAc <span class="ot">&lt;-</span> ExprModVar<span class="sc">$</span><span class="fu">new</span>(<span class="st">&quot;cAc&quot;</span>, <span class="st">&quot;GBP&quot;</span>, rlang<span class="sc">::</span><span class="fu">quo</span>(dmca <span class="sc">+</span> ccca <span class="sc">+</span> cAZT <span class="sc">+</span> cLam))</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>cBc <span class="ot">&lt;-</span> ExprModVar<span class="sc">$</span><span class="fu">new</span>(<span class="st">&quot;cBc&quot;</span>, <span class="st">&quot;GBP&quot;</span>, rlang<span class="sc">::</span><span class="fu">quo</span>(dmcb <span class="sc">+</span> cccb <span class="sc">+</span> cAZT <span class="sc">+</span> cLam))</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>cCc <span class="ot">&lt;-</span> ExprModVar<span class="sc">$</span><span class="fu">new</span>(<span class="st">&quot;cCc&quot;</span>, <span class="st">&quot;GBP&quot;</span>, rlang<span class="sc">::</span><span class="fu">quo</span>(dmcc <span class="sc">+</span> cccc <span class="sc">+</span> cAZT <span class="sc">+</span> cLam))</span></code></pre></div>
</div>
<div id="treatment-effect-1" class="section level2">
<h2>Treatment effect</h2>
<p>The treatment effect is also represented by a <code>ModVar</code>
whose uncertainty follows a log normal distribution.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>RR <span class="ot">&lt;-</span> LogNormModVar<span class="sc">$</span><span class="fu">new</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Tx effect&quot;</span>, <span class="st">&quot;RR&quot;</span>, <span class="at">p1 =</span> <span class="fl">0.509</span>, <span class="at">p2 =</span> (<span class="fl">0.710</span> <span class="sc">-</span> <span class="fl">0.365</span>) <span class="sc">/</span> (<span class="fl">2.0</span> <span class="sc">*</span> <span class="fl">1.96</span>), <span class="st">&quot;LN7&quot;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="transition-matrix" class="section level2">
<h2>Transition matrix</h2>
<p>The following function generates a transition probability matrix from
observed counts, using Dirichlet distributions, as described by Briggs
<em>et al</em>. This could be achieved using the R <code>stats</code>
function <code>rgamma</code>, but <code>rdecision</code> offers the
<code>DirichletDistribition</code> class for convenience, which is used
here.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function to generate a probabilistic transition matrix</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>pt_prob <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create Dirichlet distributions for conditional probabilities</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  DA <span class="ot">&lt;-</span> DirichletDistribution<span class="sc">$</span><span class="fu">new</span>(<span class="fu">c</span>(1251L, 350L, 116L, 17L)) <span class="co"># from A # nolint</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  DB <span class="ot">&lt;-</span> DirichletDistribution<span class="sc">$</span><span class="fu">new</span>(<span class="fu">c</span>(731L, 512L, 15L))  <span class="co"># from B # nolint</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  DC <span class="ot">&lt;-</span> DirichletDistribution<span class="sc">$</span><span class="fu">new</span>(<span class="fu">c</span>(1312L, 437L)) <span class="co"># from C # nolint</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sample from the Dirichlet distributions</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  DA<span class="sc">$</span><span class="fu">sample</span>()</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  DB<span class="sc">$</span><span class="fu">sample</span>()</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  DC<span class="sc">$</span><span class="fu">sample</span>()</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create the transition matrix</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  Pt <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(DA<span class="sc">$</span><span class="fu">r</span>(), <span class="fu">c</span>(<span class="fl">0.0</span>, DB<span class="sc">$</span><span class="fu">r</span>()), <span class="fu">c</span>(<span class="fl">0.0</span>, <span class="fl">0.0</span>, DC<span class="sc">$</span><span class="fu">r</span>()), <span class="fu">c</span>(<span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="fl">1.0</span>)),</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> 4L,</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">dimnames =</span> <span class="fu">list</span>(</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">source =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>), <span class="at">target =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Pt)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="running-the-psa" class="section level2">
<h2>Running the PSA</h2>
<p>The following code runs 1000 iterations of the model. At each run,
the model variables are sampled from their uncertainty distributions,
the transition matrix is sampled from count data, and the treatment
effect is applied. Functions <code>run_mono</code> and
<code>run_comb</code> are used to generate Markov traces for each form
of therapy, and the incremental costs, life years and ICER for each run
are saved in a matrix.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create matrix to hold the incremental costs and life years for each run</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>psa <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="cn">NA_real_</span>, <span class="at">nrow =</span> 1000L, <span class="at">ncol =</span> 5L,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">dimnames =</span> <span class="fu">list</span>(</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NULL</span>, <span class="fu">c</span>(<span class="st">&quot;el.mono&quot;</span>, <span class="st">&quot;cost.mono&quot;</span>, <span class="st">&quot;el.comb&quot;</span>, <span class="st">&quot;cost.comb&quot;</span>, <span class="st">&quot;icer&quot;</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># run the model repeatedly</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (irun <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(psa))) {</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sample variables from their uncertainty distributions</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  cAm<span class="sc">$</span><span class="fu">set</span>(<span class="st">&quot;random&quot;</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  cBm<span class="sc">$</span><span class="fu">set</span>(<span class="st">&quot;random&quot;</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  cCm<span class="sc">$</span><span class="fu">set</span>(<span class="st">&quot;random&quot;</span>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  cAc<span class="sc">$</span><span class="fu">set</span>(<span class="st">&quot;random&quot;</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  cBc<span class="sc">$</span><span class="fu">set</span>(<span class="st">&quot;random&quot;</span>)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  cCc<span class="sc">$</span><span class="fu">set</span>(<span class="st">&quot;random&quot;</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  RR<span class="sc">$</span><span class="fu">set</span>(<span class="st">&quot;random&quot;</span>)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sample the probability transition matrix from observed counts</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  Ptm <span class="ot">&lt;-</span> <span class="fu">pt_prob</span>()</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run monotherapy model</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  MT.mono <span class="ot">&lt;-</span> <span class="fu">run_mono</span>(Ptm, cAm, cBm, cCm, <span class="at">hcc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>  el.mono <span class="ot">&lt;-</span> <span class="fu">sum</span>(MT.mono<span class="sc">$</span>QALY)</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>  cost.mono <span class="ot">&lt;-</span> <span class="fu">sum</span>(MT.mono<span class="sc">$</span>Cost)</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>  psa[[irun, <span class="st">&quot;el.mono&quot;</span>]] <span class="ot">&lt;-</span> el.mono</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>  psa[[irun, <span class="st">&quot;cost.mono&quot;</span>]] <span class="ot">&lt;-</span> cost.mono</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create Pt for combination therapy (Briggs applied the RR to the transition</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># probabilities - not recommended, but done here for reproducibility).</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>  Ptc <span class="ot">&lt;-</span> Ptm</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> 1L<span class="sc">:</span>4L) {</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> 1L<span class="sc">:</span>4L) {</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>      Ptc[[i, j]] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(i <span class="sc">==</span> j, <span class="cn">NA</span>, RR<span class="sc">$</span><span class="fu">get</span>() <span class="sc">*</span> Ptc[[i, j]])</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>    Ptc[i, <span class="fu">which</span>(<span class="fu">is.na</span>(Ptc[i, ]))] <span class="ot">&lt;-</span> <span class="fl">1.0</span> <span class="sc">-</span> <span class="fu">sum</span>(Ptc[i, ], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run combination therapy model</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>  MT.comb <span class="ot">&lt;-</span> <span class="fu">run_comb</span>(Ptm, cAm, cBm, cCm, Ptc, cAc, cBc, cCc, <span class="at">hcc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>  el.comb <span class="ot">&lt;-</span> <span class="fu">sum</span>(MT.comb<span class="sc">$</span>QALY)</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>  cost.comb <span class="ot">&lt;-</span> <span class="fu">sum</span>(MT.comb<span class="sc">$</span>Cost)</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>  psa[[irun, <span class="st">&quot;el.comb&quot;</span>]] <span class="ot">&lt;-</span> el.comb</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>  psa[[irun, <span class="st">&quot;cost.comb&quot;</span>]] <span class="ot">&lt;-</span> cost.comb</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the icer</span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>  psa[[irun, <span class="st">&quot;icer&quot;</span>]] <span class="ot">&lt;-</span> (cost.comb <span class="sc">-</span> cost.mono) <span class="sc">/</span> (el.comb <span class="sc">-</span> el.mono)</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<blockquote>
<p>Coding note: The state occupancy costs <code>cAm</code>,
<code>cBm</code> etc. are now <code>ModVar</code>s, rather than numeric
variables as they were in the deterministic model. However, they can
still be passed as arguments to <code>MarkovState$set_cost()</code>, via
the arguments to helper functions <code>run_mono</code> and
<code>run_comb</code>, and <code>rdecision</code> will manage them
appropriately, without changing any other code. Documentation for
functions in <code>rdecision</code> explains where this is supported by
the package.</p>
</blockquote>
</div>
<div id="results" class="section level2">
<h2>Results</h2>
<p>The mean (95% confidence interval) for the cost of monotherapy was
45,007 (22,208 to 92,719) GBP, and the mean (95% CI) cost for
combination therapy was 50,841 (27,858 to 96,642) GBP. The life years
gained for monotherapy was 8.488 (8.105 to 8.928), and the life years
gained for combination therapy was 9.429 (8.928 to 9.962). The mean ICER
was 6,388 GBP/QALY with 95% confidence interval 2,863 to 11,089
GBP/QALY.</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body" line-spacing="2">
<div id="ref-briggs2006" class="csl-entry">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Briggs, A., Claxton, K. &amp; Sculpher, M.
<em>Decision modelling for health economic evaluation</em>. (Oxford
University Press, 2006).</div>
</div>
<div id="ref-chancellor1997" class="csl-entry">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Chancellor, J. V., Hill, A. M., Sabin, C. A.,
Simpson, K. N. &amp; Youle, M. Modelling the cost effectiveness of
lamivudine/zidovudine combination therapy in <span>HIV</span> infection.
<em>Pharmacoeconomics</em> <strong>12,</strong> 5466 (1997).</div>
</div>
<div id="ref-welton2005" class="csl-entry">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Welton, N. J. &amp; Ades, A. E. <a href="https://doi.org/10.1177/0272989X05282637">Estimation of markov
chain transition probabilities and rates from fully and partially
observed data: Uncertainty propagation, evidence synthesis, and model
calibration</a>. <em>Med Decis Making</em> <strong>25,</strong> 633645
(2005).</div>
</div>
<div id="ref-miller1994" class="csl-entry">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">Miller, D. K. &amp; Homan, S. M. <a href="https://doi.org/10.1177/0272989X9401400107">Determining transition
probabilities: Confusion and suggestions</a>. <em>Med Decis Making</em>
<strong>14,</strong> 5258 (1994).</div>
</div>
<div id="ref-jones2017" class="csl-entry">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">Jones, E., Epstein, D. &amp; Garca-Mochn, L.
<a href="https://doi.org/10.1177/0272989X17696997">A procedure for
deriving formulas to convert transition rates to probabilities for
multistate markov models</a>. <em>Med Decis Making</em>
<strong>37,</strong> 779789 (2017).</div>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
